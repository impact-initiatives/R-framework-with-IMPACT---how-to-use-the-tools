[
  {
    "objectID": "02-session2.html",
    "href": "02-session2.html",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "",
    "text": "library(cleaningtools)\nlibrary(dplyr)\n\nmy_raw_dataset &lt;- cleaningtools::cleaningtools_raw_data\nmy_kobo_survey &lt;- cleaningtools::cleaningtools_survey\nmy_kobo_choice &lt;- cleaningtools::cleaningtools_choices\nEn esta sección continuamos con el paso de limpieza.",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#create_combined_log",
    "href": "02-session2.html#create_combined_log",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "create_combined_log",
    "text": "create_combined_log\nLa función create_combined_log combina todos los registros de una lista en uno. La función añade también dos columnas necesarias durante el proceso de limpieza.\n\nnames(more_logs)\n\n[1] \"checked_dataset\"    \"duplicate_log\"      \"soft_duplicate_log\"\n[4] \"potential_outliers\" \"flaged_value\"       \"duration_log\"      \n[7] \"other_log\"          \"logical_all\"       \n\nmy_combined_log &lt;- create_combined_log(more_logs)\n\nList of element to combine- checked_dataset, duplicate_log, soft_duplicate_log, potential_outliers, flaged_value, duration_log, other_log, logical_all\n\ntypeof(my_combined_log)\n\n[1] \"list\"\n\nnames(my_combined_log)\n\n[1] \"checked_dataset\" \"cleaning_log\"   \n\nmy_combined_log$cleaning_log %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nuuid\nold_value\nquestion\nissue\ncheck_id\ncheck_binding\nchange_type\nnew_value\n\n\n\nb5b1d37a-e27a-4c35-a0f5-2cde9d6dfd06\n86\nage_respondent_r\noutlier (normal distribution)\nNA\nage_respondent_r / b5b1d37a-e27a-4c35-a0f5-2cde9d6dfd06\nNA\nNA\n\n\n956b5ed0-5a62-41b7-aec3-af93fbc5b494\n84\nage_respondent_r\noutlier (normal distribution)\nNA\nage_respondent_r / 956b5ed0-5a62-41b7-aec3-af93fbc5b494\nNA\nNA\n\n\n97ad6294-30c6-454e-a0b3-42126415b767\n18\nage_respondent_r\noutlier (log distribution)\nNA\nage_respondent_r / 97ad6294-30c6-454e-a0b3-42126415b767\nNA\nNA\n\n\ne005e719-57c4-44a3-ac2f-5d6d1ff68831\n18\nage_respondent_r\noutlier (log distribution)\nNA\nage_respondent_r / e005e719-57c4-44a3-ac2f-5d6d1ff68831\nNA\nNA\n\n\nc9aaa542-118f-4e42-93de-fb0916572541\n19\nnum_hh_member\noutlier (normal distribution)\nNA\nnum_hh_member / c9aaa542-118f-4e42-93de-fb0916572541\nNA\nNA\n\n\n48e8896b-d1be-4600-8839-2d8b994ebcfb\n19\nnum_hh_member\noutlier (normal distribution)\nNA\nnum_hh_member / 48e8896b-d1be-4600-8839-2d8b994ebcfb\nNA\nNA\n\n\n\n\n\n\nEl registro de limpieza contiene todas las columnas de todos los registros en more_logs y ademas contiene las siguientes columnas:\n\ncheck_binding : esta columna se rellena automáticamente.\nchange_type (vacía)\nnew_value (vacía)",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#add_info_to_cleaning_log",
    "href": "02-session2.html#add_info_to_cleaning_log",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "add_info_to_cleaning_log",
    "text": "add_info_to_cleaning_log\nSi se desea añadir mas información al registro de limpieza, se puede usar la función add_info_to_cleaning_log.\n\n\n\n\n\n\nadd_*\n\n\n\n\nLas funciones add_* añaden una variable (columna) al conjunto de datos. Por ejemplo, se puede añadir la duración de la encuesta o la categoría de puntaje de consumo de alimentos (FCS)…\nUna función add_* toma a un conjunto de datos como entrada y retorna el conjunto de datos incluyendo el nuevo indicador (tambien añadira todos las columnas necesarias para el calculo del nuevo indicador).\nPor ejemplo, para comprobar la duración de una encuesta teniendo las variables de inicio y fin de la encuesta.\n\n\n\nmy_combined_log &lt;- my_combined_log %&gt;% \n  add_info_to_cleaning_log(dataset_uuid_column = \"X_uuid\", \n                           information_to_add = \"enumerator_num\")\n\nmy_combined_log$cleaning_log %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nuuid\nold_value\nquestion\nissue\ncheck_id\ncheck_binding\nchange_type\nnew_value\nenumerator_num\n\n\n\n019bc718-c06a-46b8-bba8-c84f6c6efbd5\nلا اعلم\nwater_supply_other_neighbourhoods_why\nrecode other\nNA\nwater_supply_other_neighbourhoods_why / 019bc718-c06a-46b8-bba8-c84f6c6efbd5\nNA\nNA\n12\n\n\n019bc718-c06a-46b8-bba8-c84f6c6efbd5\nلا ارى جدوى من ذلك\nprefer_not_engage_other\nrecode other\nNA\nprefer_not_engage_other / 019bc718-c06a-46b8-bba8-c84f6c6efbd5\nNA\nNA\n12\n\n\n019bc718-c06a-46b8-bba8-c84f6c6efbd5\nالسلطات ليست مهتمة بالخدمات\ntrust_water_office_why_not\nrecode other\nNA\ntrust_water_office_why_not / 019bc718-c06a-46b8-bba8-c84f6c6efbd5\nNA\nNA\n12\n\n\n019bc718-c06a-46b8-bba8-c84f6c6efbd5\n247.20\nduration\nDuration is lower or higher than the thresholds\nNA\nduration / 019bc718-c06a-46b8-bba8-c84f6c6efbd5\nNA\nNA\n12\n\n\n03183d24-0275-43fe-8976-d076f29de590\nعدم توفير خدمه المياه في المنطقه وضعف في تزويد خدمه وعدد ساعات اقل تجهيز للبيوت\nwater_supply_other_neighbourhoods_why\nrecode other\nNA\nwater_supply_other_neighbourhoods_why / 03183d24-0275-43fe-8976-d076f29de590\nNA\nNA\n2\n\n\n03183d24-0275-43fe-8976-d076f29de590\n10\npay_water_charges_amount\noutlier (log distribution)\nNA\npay_water_charges_amount / 03183d24-0275-43fe-8976-d076f29de590\nNA\nNA\n2",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#create_xlsx_cleaning_log",
    "href": "02-session2.html#create_xlsx_cleaning_log",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "create_xlsx_cleaning_log",
    "text": "create_xlsx_cleaning_log\n\ncreate_xlsx_cleaning_log(my_combined_log,\n                         sm_dropdown_type = \"logical\",\n                         output_path =  \"outputs/01 - example - cleaning-log-no-kobo.xlsx\")\n\nLa función create_xlsx_cleaning_log crea una tabla Excel que contiene:\n\nchecked_dataset: la pestaña con el conjunto de datos verificado y las columnas añadidas si hay.\ncleaning_log: la pestaña con los registros combinados y la columna change_type que describe las posibles modificaciones.\nreadme tab: la pestaña con la definición de las opciones para la columna change_type (en inglés).\n\nHay 4 acciones posibles:\n\nchange_response: cambiar al valor especificado en la columna new.value,\nblank_response: remplazar el valor por NA,\nremove_survey: borrar la encuesta,\nno_action: no hacer nada.\n\nEn el registro se debe indicar la acción por hacer y, si necesario, el nuevo valor.\n\ncreate_xlsx_cleaning_log(my_combined_log,\n                         kobo_survey = my_kobo_survey,\n                         kobo_choices = my_kobo_choice,\n                         use_dropdown = T,\n                         sm_dropdown_type = \"logical\",\n                         output_path =  \"outputs/02 - example - cleaning-log-with-kobo.xlsx\")\n\nEn las entradas de la función, se puede especificar la herramienta KOBO. Si se específica la herramienta y que el argumento use_dropdown está configurado como TRUE, new_value tendrá una regla de validación de datos basada en las opciones de la herramienta KOBO.\n\n\n\n\n\n\nNota\n\n\n\nEn el caso de variables de opción multiple, se señalan las columnas ficticias (TRUE/FALSE o 0/1 i.e. dummy columns) y son esas las columnas usadas durante el proceso de limpieza, no la columna principal.",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#review_cleaning_log",
    "href": "02-session2.html#review_cleaning_log",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "review_cleaning_log",
    "text": "review_cleaning_log\nLa funcion review_cleaning_log revisa como se relleno el registro de limpieza.\n\nmy_filled_log &lt;- readxl::read_excel(\"inputs/02 - example - cleaning-log-with-kobo - filled.xlsx\", sheet = 2)\n\ncheck_log_results &lt;- review_cleaning_log(raw_dataset = my_raw_dataset,\n                                        raw_data_uuid_column = \"X_uuid\",\n                                        cleaning_log = my_filled_log, \n                                        cleaning_log_uuid_column = \"uuid\",\n                                        cleaning_log_question_column = \"question\",\n                                        cleaning_log_new_value_column = \"new_value\",\n                                        cleaning_log_change_type_column = \"change_type\",\n                                        change_response_value = \"change_response\")\ncheck_log_results\n\n[1] \"no issues in cleaning log found\"",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#create_clean_data",
    "href": "02-session2.html#create_clean_data",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "create_clean_data",
    "text": "create_clean_data\nPara crear el conjunto de datos limpio, la función create_clean_data necesita el conjunto de datos bruto y el registro de limpieza completado.\n\nmy_clean_data &lt;- create_clean_data(raw_dataset = my_raw_dataset,\n                                   raw_data_uuid_column = \"X_uuid\",\n                                   cleaning_log = my_filled_log, \n                                   cleaning_log_uuid_column = \"uuid\",\n                                   cleaning_log_question_column = \"question\",\n                                   cleaning_log_new_value_column = \"new_value\",\n                                   cleaning_log_change_type_column = \"change_type\")\n\n[1] \"water_supply_other_neighbourhoods_why\"\n[1] \"trust_water_office_why_not\"\n[1] \"pay_water_charges_amount\"\n[1] \"connection_fees_amount\"\n[1] \"connection_fees_amount\"\n[1] \"primary_livelihood.employment\"\n[1] \"primary_livelihood.employment\"\n[1] \"primary_livelihood.employment\"\n[1] \"tank_emptied\"\n[1] \"access_water_enough\"",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#recreate_parent_column",
    "href": "02-session2.html#recreate_parent_column",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "recreate_parent_column",
    "text": "recreate_parent_column\nEn el siguiente ejemplo, en el registro de limpieza, se modifican ciertas columnas de opción multiple pero solo se registraron las modificaciones hechas a las columnas ficticias (TRUE/FALSE , 0/1 i.e. dummy variables).\n\nmy_filled_log %&gt;% \n  filter(question == \"primary_livelihood.employment\", \n         change_type == \"change_response\") %&gt;% \n  select(uuid, question, old_value, new_value)\n\n\n\n\n\n\n\n\n\n\nuuid\nquestion\nold_value\nnew_value\n\n\n\neb3b9935-fa0b-4d54-8058-3b629f1421ad\nprimary_livelihood.employment\nTRUE\nFALSE\n\n\neec1f630-15d5-475e-a344-32bba74b32ea\nprimary_livelihood.employment\nTRUE\nFALSE\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\nprimary_livelihood.employment\nTRUE\nFALSE\n\n\n\n\n\n\nLa columna principal no fue modificada y por lo tanto, acorde al ejemplo anterior, ‘employment’ sigue marcado en la columna principal.\n\nmy_clean_data %&gt;% \n  filter(X_uuid %in% c(\"eb3b9935-fa0b-4d54-8058-3b629f1421ad\", \"eec1f630-15d5-475e-a344-32bba74b32ea\", \"f1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\")) %&gt;% \n  select(X_uuid,primary_livelihood, primary_livelihood.employment)\n\n\n\n\n\n\n\n\n\nX_uuid\nprimary_livelihood\nprimary_livelihood.employment\n\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\nemployment\nFALSE\n\n\neb3b9935-fa0b-4d54-8058-3b629f1421ad\nemployment ngo\nFALSE\n\n\neec1f630-15d5-475e-a344-32bba74b32ea\nemployment\nFALSE\n\n\n\n\n\n\nLa función recreate_parent_column modifica la columna principal basandosé en las columnas ficticias.\n\nmy_clean_data2 &lt;- recreate_parent_column(dataset = my_clean_data,\n                                         uuid_column = \"X_uuid\",\n                                         kobo_survey = my_kobo_survey,\n                                         kobo_choices = my_kobo_choice,\n                                         sm_separator = \".\", \n                                         cleaning_log_to_append = my_filled_log)\n\nComo se puede ver, la columna principal esta correcta y ‘employment’ ya no aparece como respuesta.\n\nmy_clean_data2$data_with_fix_concat %&gt;% \n  filter(X_uuid %in% c(\"eb3b9935-fa0b-4d54-8058-3b629f1421ad\", \"eec1f630-15d5-475e-a344-32bba74b32ea\", \"f1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\")) %&gt;% \n  select(X_uuid,primary_livelihood, primary_livelihood.employment)\n\n\n\n\n\n\n\n\n\nX_uuid\nprimary_livelihood\nprimary_livelihood.employment\n\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\nNA\nFALSE\n\n\neb3b9935-fa0b-4d54-8058-3b629f1421ad\nngo\nFALSE\n\n\neec1f630-15d5-475e-a344-32bba74b32ea\nNA\nFALSE\n\n\n\n\n\n\nAl haber especificado el parametro cleaning_log_to_append, los cambios hechos fueron añadidos al registro de limpieza.\n\nmy_clean_data2$cleaning_log %&gt;% \n  filter(question == \"primary_livelihood\", \n         uuid %in% c(\"eb3b9935-fa0b-4d54-8058-3b629f1421ad\", \"eec1f630-15d5-475e-a344-32bba74b32ea\", \"f1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\")) %&gt;% \n  select(uuid, question, old_value, new_value)\n\n\n\n\n\n\n\n\n\n\nuuid\nquestion\nold_value\nnew_value\n\n\n\neb3b9935-fa0b-4d54-8058-3b629f1421ad\nprimary_livelihood\nemployment ngo\nngo\n\n\neec1f630-15d5-475e-a344-32bba74b32ea\nprimary_livelihood\nemployment\nNA\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\nprimary_livelihood\nemployment\nNA",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#review_others",
    "href": "02-session2.html#review_others",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "review_others",
    "text": "review_others\nEn el registro de limpieza, algunos valores de texto abierto se cambian a vacío. Algunas preguntas de texto abierto están vinculadas a una lógica condicional, es decir, ¿qué es X? Otro, por favor especifique. En algunos casos, algunos valores deben ser cambiados. En el siguiente ejemplo, se cambio el valor de water_supply_other_neighbourhoods_why* de la encuesta uuid 019bc718-c06a-46b8-bba8-c84f6c6efbd5.\n\nmy_filled_log %&gt;% \n  filter(question == \"water_supply_other_neighbourhoods_why\", \n         change_type == \"blank_response\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nuuid\nold_value\nquestion\nissue\ncheck_id\ncheck_binding\nchange_type\nnew_value\nenumerator_num\n\n\n019bc718-c06a-46b8-bba8-c84f6c6efbd5\nلا اعلم\nwater_supply_other_neighbourhoods_why\nrecode other\nNA\nwater_supply_other_neighbourhoods_why / 019bc718-c06a-46b8-bba8-c84f6c6efbd5\nblank_response\nNA\n12\n\n\n\n\n\nEn la herramienta KOBO se puede notar una logical condicional basada en la variable water_supply_other_neighbourhoods.\n\nmy_kobo_survey %&gt;% \n  filter(name == \"water_supply_other_neighbourhoods_why\") %&gt;% \n  select(type, name, relevant)\n\n\n\n\n\n\n\n\n\ntype\nname\nrelevant\n\n\ntext\nwater_supply_other_neighbourhoods_why\nselected(\\({water_supply_other_neighbourhoods},'somewhat_worse') or selected(\\){water_supply_other_neighbourhoods},‘much_worse’)\n\n\n\n\n\n\nmy_clean_data %&gt;% \n  filter(X_uuid == \"019bc718-c06a-46b8-bba8-c84f6c6efbd5\") %&gt;% \n  select(water_supply_other_neighbourhoods, water_supply_other_neighbourhoods_why   )\n\n\n\n\n\n\n\n\nwater_supply_other_neighbourhoods\nwater_supply_other_neighbourhoods_why\n\n\nsomewhat_worse\nNA\n\n\n\n\n\n¿Debe cambiarse el valor de water_supply_other_neighbourhoods? Depende de la pregunta y de la lógica condicional, pero es importante señalarlos para que se pueda tomar una decisión.\n\nreview_other_log &lt;- review_others(dataset = my_clean_data2$data_with_fix_concat,\n                                  uuid_column = \"X_uuid\", \n                                  kobo_survey = my_kobo_survey, \n                                  columns_not_to_check = \"consent_telephone_number\")\n\nWarning in create_logic_for_other(kobo_survey = kobo_survey,\ncompare_with_dataset = TRUE, : The following parent names: well_quality,\nspring_quality, rainwater_quality, surface_quality, why_not_connected were not\nfound in the dataset. The function is ignoring them.",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#review_cleaning",
    "href": "02-session2.html#review_cleaning",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "review_cleaning",
    "text": "review_cleaning\n\nmy_deletion_log &lt;- my_clean_data2$cleaning_log %&gt;% \n  filter(change_type == \"remove_survey\")\n\nmy_filled_log_no_deletion &lt;- my_clean_data2$cleaning_log %&gt;% \n  filter(change_type != \"remove_survey\") %&gt;% \n  filter(!uuid %in% my_deletion_log$uuid)\n\nreview_of_cleaning &lt;- review_cleaning(raw_dataset = my_raw_dataset,\n                    raw_dataset_uuid_column = \"X_uuid\", \n                    clean_dataset = my_clean_data2$data_with_fix_concat,\n                    clean_dataset_uuid_column = \"X_uuid\",\n                    cleaning_log = my_filled_log_no_deletion, \n                    cleaning_log_uuid_column = \"uuid\",\n                    cleaning_log_question_column = \"question\",\n                    cleaning_log_new_value_column = \"new_value\",\n                    cleaning_log_change_type_column = \"change_type\", \n                    cleaning_log_old_value_column = \"old_value\", \n                    deletion_log = my_deletion_log, \n                    deletion_log_uuid_column = \"uuid\"\n                    )",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#ejercicio-1",
    "href": "02-session2.html#ejercicio-1",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "Ejercicio 1",
    "text": "Ejercicio 1\n\nExporte el registro de limpieza creado previamente. El registro anterior ya esta cargado.\n\n\nprevious_exercise_log &lt;- readRDS(\"inputs/03 - exercise - previous_log.RDS\")\n\nprevious_exercise_log %&gt;% names()\n\n[1] \"checked_dataset\"        \"percentage_missing_log\" \"potential_PII\"         \n[4] \"logical_all\"           \n\n\n\n\n\n\n\n\nHaga clic para obtener una pista.\n\n\n\n\n\n¿Intento usando la funcion create_combined_log ?\n\n\n\n\n\n\n\n\n\nHaga clic para obtener una pista.\n\n\n\n\n\n¿Intento usando la funcion create_xlsx_cleaning_log ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nprevious_exercise_log %&gt;% \n  create_combined_log() %&gt;%\n  create_xlsx_cleaning_log(output_path = \"outputs/03 - correction - cleaning_log.xlsx\", \n                           kobo_survey = my_kobo_survey,\n                           kobo_choices = my_kobo_choice,\n                           sm_dropdown_type = \"logical\",\n                           use_dropdown = TRUE)",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#ejercicio-2",
    "href": "02-session2.html#ejercicio-2",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "Ejercicio 2",
    "text": "Ejercicio 2\n\nCree los datos limpios a partir del conjunto de datos en bruto y del registro de limpieza completado.\n\n\nexercise_filled_log &lt;- readxl::read_excel(\"inputs/04 - exercise - cleaning_log - filled.xlsx\", sheet = \"cleaning_log\")\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento usando la funcion create_clean_data ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento usando la funcion recreate_parent_column ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nexercise_clean_dataset &lt;- create_clean_data(raw_dataset = my_raw_dataset,\n                                            raw_data_uuid_column = \"X_uuid\",\n                                            cleaning_log = exercise_filled_log, \n                                            cleaning_log_uuid_column = \"uuid\",\n                                            cleaning_log_question_column = \"question\",\n                                            cleaning_log_new_value_column = \"new_value\",\n                                            cleaning_log_change_type_column = \"change_type\")\n\n\nexercise_clean_dataset2 &lt;- recreate_parent_column(exercise_clean_dataset,\n                                                  uuid_column = \"X_uuid\", \n                                                  kobo_survey = my_kobo_survey,\n                                                  kobo_choices = my_kobo_choice,\n                                                  cleaning_log_to_append = exercise_filled_log)",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#ejercicio-3",
    "href": "02-session2.html#ejercicio-3",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "Ejercicio 3",
    "text": "Ejercicio 3\n\nRevise la limpieza a continuación; si hay alguien más haciendo el ejercicio, puede intentar revisar la limpieza de esa persona.\n\n\nexercise3_clean_dataset &lt;- readxl::read_excel(\"inputs/05 - exercise - clean dataset for review.xlsx\")\n\nexercise3_cleaning_log &lt;- readxl::read_excel(\"inputs/05 - exercise - clean dataset for review.xlsx\", sheet = 2)\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento usando la funcion review_cleaning ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿ Separo el registro de limpieza ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nexercise3_deletion_log &lt;- exercise3_cleaning_log %&gt;% \n  filter(change_type == \"remove_survey\")\n\nexercise3_log_no_deletion &lt;- exercise3_cleaning_log %&gt;% \n  filter(change_type != \"remove_survey\") %&gt;% \n  filter(!uuid %in% exercise3_deletion_log$uuid)\n\nreview_of_cleaning &lt;- review_cleaning(raw_dataset = my_raw_dataset,\n                                      raw_dataset_uuid_column = \"X_uuid\", \n                                      clean_dataset = exercise3_clean_dataset,\n                                      clean_dataset_uuid_column = \"X_uuid\",\n                                      cleaning_log = exercise3_log_no_deletion, \n                                      cleaning_log_uuid_column = \"uuid\",\n                                      cleaning_log_question_column = \"question\",\n                                      cleaning_log_new_value_column = \"new_value\",\n                                      cleaning_log_change_type_column = \"change_type\", \n                                      cleaning_log_old_value_column = \"old_value\", \n                                      deletion_log = exercise3_deletion_log, \n                                      deletion_log_uuid_column = \"uuid\"\n)",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#add_fcs",
    "href": "02-session2.html#add_fcs",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "add_fcs",
    "text": "add_fcs\n\nmy_data_with_fcs &lt;- my_data %&gt;% add_fcs(\n  cutoffs = \"normal\",\n  fsl_fcs_cereal = \"fs_fcs_cereals_grains_roots_tubers\",\n  fsl_fcs_legumes = \"fs_fcs_beans_nuts\",\n  fsl_fcs_veg = \"fs_fcs_vegetables_leaves\",\n  fsl_fcs_fruit = \"fs_fcs_fruit\",\n  fsl_fcs_meat = \"fs_fcs_meat_fish_eggs\",\n  fsl_fcs_dairy = \"fs_fcs_dairy\",\n  fsl_fcs_sugar = \"fs_fcs_sugar\",\n  fsl_fcs_oil = \"fs_fcs_oil_fat_butter\"\n)\n\nmy_data_with_fcs[, tail(names(my_data_with_fcs), 10)] %&gt;%\n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfcs_weight_cereal1\nfcs_weight_legume2\nfcs_weight_dairy3\nfcs_weight_meat4\nfcs_weight_veg5\nfcs_weight_fruit6\nfcs_weight_oil7\nfcs_weight_sugar8\nfsl_fcs_score\nfsl_fcs_cat\n\n\n\n0\n0\n8\n28\n5\n6\n1.0\n0.5\n48.5\nAcceptable\n\n\n4\n6\n12\n16\n7\n2\n2.5\n1.0\n50.5\nAcceptable\n\n\n8\n0\n0\n24\n7\n6\n1.0\n0.5\n46.5\nAcceptable\n\n\n14\n3\n4\n12\n4\n2\n1.0\n2.5\n42.5\nAcceptable\n\n\n6\n6\n4\n20\n6\n7\n3.5\n3.0\n55.5\nAcceptable\n\n\n0\n6\n16\n4\n7\n1\n0.0\n3.5\n37.5\nAcceptable\n\n\n\n\n\n\n\n\n\n\n\n\n\nNota\n\n\n\nEn este enlace entrará mas información sobre los indicadores de seguridad alimentaria.",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#add_hhs",
    "href": "02-session2.html#add_hhs",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "add_hhs",
    "text": "add_hhs\n\n\n\n\n\n\nPipe-able (encadenable)\n\n\n\nEl marco se basa en 2 adjetivos, pipeable (encadenable) e independiente. En particular, funciones de la misma familia deben ser encadenable. En el siguiente ejemplo, se encadenan dos funciones add_*.\n\n\n\nmy_data_with_indicators &lt;- my_data %&gt;%\n  add_fcs(\n  cutoffs = \"normal\",\n  fsl_fcs_cereal = \"fs_fcs_cereals_grains_roots_tubers\",\n  fsl_fcs_legumes = \"fs_fcs_beans_nuts\",\n  fsl_fcs_veg = \"fs_fcs_vegetables_leaves\",\n  fsl_fcs_fruit = \"fs_fcs_fruit\",\n  fsl_fcs_meat = \"fs_fcs_meat_fish_eggs\",\n  fsl_fcs_dairy = \"fs_fcs_dairy\",\n  fsl_fcs_sugar = \"fs_fcs_sugar\",\n  fsl_fcs_oil = \"fs_fcs_oil_fat_butter\"\n  ) %&gt;%\n  add_hhs(\n  )\n\nmy_data_with_indicators[, tail(names(my_data_with_indicators), 14)] %&gt;%\n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfsl_fcs_score\nfsl_fcs_cat\nfs_hhs_nofood_yn_recoded\nfs_hhs_nofood_freq_recoded\nfs_hhs_sleephungry_yn_recoded\nfs_hhs_sleephungry_freq_recoded\nfs_hhs_daynoteating_yn_recoded\nfs_hhs_daynoteating_freq_recoded\nhhs_comp1\nhhs_comp2\nhhs_comp3\nhhs_score\nhhs_cat_ipc\nhhs_cat\n\n\n\n48.5\nAcceptable\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\nNone\nNo or Little\n\n\n50.5\nAcceptable\n1\n1\n0\n0\n0\n1\n1\n0\n0\n1\nLittle\nNo or Little\n\n\n46.5\nAcceptable\n0\n0\n1\n2\n1\n0\n0\n2\n0\n2\nModerate\nModerate\n\n\n42.5\nAcceptable\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\nNone\nNo or Little\n\n\n55.5\nAcceptable\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\nNone\nNo or Little\n\n\n37.5\nAcceptable\n1\n1\n0\n2\n1\n2\n1\n0\n2\n3\nModerate\nModerate",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#review_variables",
    "href": "02-session2.html#review_variables",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "review_variables",
    "text": "review_variables\nPrimero, creamos un nuevo conjunto de datos para la revisión.\n\nreview_df &lt;- addindicators_MSNA_template_data %&gt;%\n  add_fcs(\n  cutoffs = \"normal\",\n  fsl_fcs_cereal = \"fs_fcs_cereals_grains_roots_tubers\",\n  fsl_fcs_legumes = \"fs_fcs_beans_nuts\",\n  fsl_fcs_veg = \"fs_fcs_vegetables_leaves\",\n  fsl_fcs_fruit = \"fs_fcs_fruit\",\n  fsl_fcs_meat = \"fs_fcs_meat_fish_eggs\",\n  fsl_fcs_dairy = \"fs_fcs_dairy\",\n  fsl_fcs_sugar = \"fs_fcs_sugar\",\n  fsl_fcs_oil = \"fs_fcs_oil_fat_butter\"\n  ) %&gt;%\n  select(uuid, fsl_fcs_score, fsl_fcs_cat)\n\nLuego, unimos los datos por revisar y el nuevo conjunto de datos.\n\nbinded_df &lt;- my_data_with_indicators %&gt;%\n  full_join(review_df, by = \"uuid\")\n\n\n\n\n\n\n\n\nNota\n\n\n\nSe recomienda usar un full_join en ligar de un left/right_join. De esa manera, se detectará si faltan valores.\n\n\n\n\n\n\n\nNota\n\n\n\nAl usar la función join_*, si hay dos columnas con el mismo nombre en los conjuntos de datos unidos, R añadira los prefijos “.x” y “.y” a dichas columnas.\n\n\n\n\n\n\n\n\nreview_*\n\n\n\n\nLas funcionesreview_* revisan un objeto comparándolo con estándares u otro objeto y marcan las diferencias. Por ejemplo, revisando la limpiezo al comparar el conjunto de datos en bruto, el conjunto de datos limpio y el registro de limpieza o realizando un análisis y comparándolo con otro análisis.\n\n\n\nreview_one_var &lt;- review_variables(binded_df,\n  columns_to_review = \"fsl_fcs_cat.x\",\n  columns_to_compare_with = \"fsl_fcs_cat.y\")\n\n\nreview_one_var %&gt;% \n  names()\n\n[1] \"dataset\"      \"review_table\"\n\n\nLa salida es una lista que contiene el conjunto de datos y una tabla de revisión.\n\nreview_one_var$review_table %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\nuuid\nvariable\nreview_check\nreview_comment\n\n\n\neaf540cd-32bd-41474b-b4beb5-d62fc987e45a\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\n89e706c3-53d8-4a4049-898586-4926085db71e\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\nafd921c6-e54a-4c4740-919c93-87f59bd0e63a\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\nd8b05f39-ba85-494c4d-808c84-9dc57823a4f1\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\nd6b42f9e-c209-4c4541-808a81-86bea53df142\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\nf1b9ec67-20db-47404d-a3ada0-1a37e5c49d02\nfsl_fcs_cat.x\nTRUE\nSame results\n\n\n\n\n\n\nSe puede hacer un resumen de la tabla de revisión para obtener una visión general mas rapidamente.\n\nreview_one_var$review_table %&gt;%\n  group_by(review_check, review_comment) %&gt;%\n  tally()\n\n\n\n\nreview_check\nreview_comment\nn\n\n\nTRUE\nSame results\n100\n\n\n\n\n\nPara ver cómo se muestran las diferencias, se introduce algo de ruido en el conjunto de datos.\n\njittered_df &lt;- binded_df\nset.seed(123)\njittered_df[sample(1:nrow(jittered_df), 5), \"fsl_fcs_cat.x\"] &lt;- sample(unique(jittered_df$fsl_fcs_cat.y), 5, T)\nset.seed(124)\njittered_df[sample(1:nrow(jittered_df), 5), \"fsl_fcs_cat.y\"] &lt;- sample(unique(jittered_df$fsl_fcs_cat.y), 5, T)\nset.seed(125)\njittered_df[sample(1:nrow(jittered_df), 5), \"fsl_fcs_cat.x\"] &lt;- NA\nset.seed(1236)\njittered_df[sample(1:nrow(jittered_df), 5), \"fsl_fcs_cat.y\"] &lt;- NA\nset.seed(1237)\njittered_df[sample(1:nrow(jittered_df), 5), \"fsl_fcs_score.x\"] &lt;- sample(unique(jittered_df$fsl_fcs_score.x), 5, T)\n\n\nreview_one_variable_jittered &lt;- review_variables(jittered_df,\n  columns_to_review = \"fsl_fcs_cat.x\",\n  columns_to_compare_with = \"fsl_fcs_cat.y\")\n\nreview_one_variable_jittered$review_table %&gt;%\n  group_by(review_check, review_comment) %&gt;%\n  tally()\n\n\n\n\nreview_check\nreview_comment\nn\n\n\n\nFALSE\nDifferent results\n9\n\n\nFALSE\nMissing in fsl_fcs_cat.x\n5\n\n\nFALSE\nMissing in fsl_fcs_cat.y\n5\n\n\nTRUE\nSame results\n81\n\n\n\n\n\n\nEl conjunto de datos tiene nuevas columnas que ayudan a filtrar para una revisión más detallada.\n\nreview_one_variable_jittered$dataset[, tail(names(review_one_variable_jittered$dataset), 5)] %&gt;%\n  head()\n\n\n\n\n\n\n\n\n\n\n\nhhs_cat\nfsl_fcs_score.y\nfsl_fcs_cat.y\nreview_check_fsl_fcs_cat.x\nreview_comment_fsl_fcs_cat.x\n\n\n\nNo or Little\n48.5\nAcceptable\nTRUE\nSame results\n\n\nNo or Little\n50.5\nAcceptable\nTRUE\nSame results\n\n\nModerate\n46.5\nAcceptable\nTRUE\nSame results\n\n\nNo or Little\n42.5\nAcceptable\nTRUE\nSame results\n\n\nNo or Little\n55.5\nAcceptable\nTRUE\nSame results\n\n\nModerate\n37.5\nPoor\nFALSE\nDifferent results\n\n\n\n\n\n\n\nreview_one_variable_jittered$dataset %&gt;%\n  filter(!review_check_fsl_fcs_cat.x) %&gt;%\n  select(uuid, fsl_fcs_cat.x, fsl_fcs_cat.y, review_check_fsl_fcs_cat.x, review_comment_fsl_fcs_cat.x)\n\n\n\n\n\n\n\n\n\n\n\nuuid\nfsl_fcs_cat.x\nfsl_fcs_cat.y\nreview_check_fsl_fcs_cat.x\nreview_comment_fsl_fcs_cat.x\n\n\n\nf1b9ec67-20db-47404d-a3ada0-1a37e5c49d02\nAcceptable\nPoor\nFALSE\nDifferent results\n\n\n42dc8573-e2d0-43484b-aaada2-c37ef865d041\nBorderline\nAcceptable\nFALSE\nDifferent results\n\n\nfcd69a08-498f-4c4b47-989799-743cbe5fd960\nNA\nAcceptable\nFALSE\nMissing in fsl_fcs_cat.x\n\n\nd36b8cfa-bf52-48434f-8b8d88-ef620d73c941\nPoor\nAcceptable\nFALSE\nDifferent results\n\n\n72095b68-8c51-484245-929b97-360eda2c4b81\nNA\nAcceptable\nFALSE\nMissing in fsl_fcs_cat.x\n\n\n675eb3d0-62ba-4e4b42-a3a4af-08f14dce6592\nPoor\nAcceptable\nFALSE\nDifferent results\n\n\n952efab8-4a32-4a4743-bcb4b8-d9a534fb8627\nPoor\nAcceptable\nFALSE\nDifferent results\n\n\n01648f7a-8521-4d4347-afa3a7-7fd83ea05916\nAcceptable\nBorderline\nFALSE\nDifferent results\n\n\n10db47e8-a721-49454a-888385-59068d4a3ef2\nPoor\nBorderline\nFALSE\nDifferent results\n\n\n46c81eb3-7243-414f40-919e98-270439d8fbc5\nNA\nAcceptable\nFALSE\nMissing in fsl_fcs_cat.x\n\n\n765d2341-5df2-43484a-8e888b-362fa085de17\nAcceptable\nNA\nFALSE\nMissing in fsl_fcs_cat.y\n\n\n0dea8527-2ab9-4e4844-88868e-8379e514ca2b\nNA\nAcceptable\nFALSE\nMissing in fsl_fcs_cat.x\n\n\nda823c6f-d215-43474c-b4b0b6-6ba519748c0f\nNA\nAcceptable\nFALSE\nMissing in fsl_fcs_cat.x\n\n\ne76f4382-b3ea-4b404e-bebfb0-a6b2d7594c18\nAcceptable\nPoor\nFALSE\nDifferent results\n\n\n42698e10-7e19-4d4744-8d8b8c-04d187cb62ae\nBorderline\nNA\nFALSE\nMissing in fsl_fcs_cat.y\n\n\nbdc23a6e-1a35-49474b-949e9b-57bf01284ea9\nAcceptable\nNA\nFALSE\nMissing in fsl_fcs_cat.y\n\n\n2bd1809c-a2c1-424b44-b7b0b4-9a53b24d0e67\nBorderline\nAcceptable\nFALSE\nDifferent results\n\n\nde416c95-845f-4d4f40-868f8c-e12b3946ad07\nAcceptable\nNA\nFALSE\nMissing in fsl_fcs_cat.y\n\n\n31f4e76d-c64e-4b4144-bbb1bf-b05ca69d823e\nAcceptable\nNA\nFALSE\nMissing in fsl_fcs_cat.y\n\n\n\n\n\n\nSi hay más de una variable por revisar, se puede usar vectores pareados.\n\nmy_review &lt;- review_variables(jittered_df,\n  columns_to_review = c(\"fsl_fcs_cat.x\", \"fsl_fcs_score.x\"),\n  columns_to_compare_with = c(\"fsl_fcs_cat.y\", \"fsl_fcs_score.y\")\n)\n\n\nmy_review$review_table %&gt;%\n  group_by(variable, review_check, review_comment) %&gt;%\n  tally()\n\n\n\n\nvariable\nreview_check\nreview_comment\nn\n\n\n\nfsl_fcs_cat.x\nFALSE\nDifferent results\n9\n\n\nfsl_fcs_cat.x\nFALSE\nMissing in fsl_fcs_cat.x\n5\n\n\nfsl_fcs_cat.x\nFALSE\nMissing in fsl_fcs_cat.y\n5\n\n\nfsl_fcs_cat.x\nTRUE\nSame results\n81\n\n\nfsl_fcs_score.x\nFALSE\nDifferent results\n5\n\n\nfsl_fcs_score.x\nTRUE\nSame results\n95\n\n\n\n\n\n\n\nmy_review$dataset %&gt;%\n  filter(!review_check_fsl_fcs_cat.x) %&gt;%\n  select(uuid, fsl_fcs_cat.x, fsl_fcs_cat.y, review_comment_fsl_fcs_cat.x)\n\n\n\n\n\n\n\n\n\n\nuuid\nfsl_fcs_cat.x\nfsl_fcs_cat.y\nreview_comment_fsl_fcs_cat.x\n\n\n\nf1b9ec67-20db-47404d-a3ada0-1a37e5c49d02\nAcceptable\nPoor\nDifferent results\n\n\n42dc8573-e2d0-43484b-aaada2-c37ef865d041\nBorderline\nAcceptable\nDifferent results\n\n\nfcd69a08-498f-4c4b47-989799-743cbe5fd960\nNA\nAcceptable\nMissing in fsl_fcs_cat.x\n\n\nd36b8cfa-bf52-48434f-8b8d88-ef620d73c941\nPoor\nAcceptable\nDifferent results\n\n\n72095b68-8c51-484245-929b97-360eda2c4b81\nNA\nAcceptable\nMissing in fsl_fcs_cat.x\n\n\n675eb3d0-62ba-4e4b42-a3a4af-08f14dce6592\nPoor\nAcceptable\nDifferent results\n\n\n952efab8-4a32-4a4743-bcb4b8-d9a534fb8627\nPoor\nAcceptable\nDifferent results\n\n\n01648f7a-8521-4d4347-afa3a7-7fd83ea05916\nAcceptable\nBorderline\nDifferent results\n\n\n10db47e8-a721-49454a-888385-59068d4a3ef2\nPoor\nBorderline\nDifferent results\n\n\n46c81eb3-7243-414f40-919e98-270439d8fbc5\nNA\nAcceptable\nMissing in fsl_fcs_cat.x\n\n\n765d2341-5df2-43484a-8e888b-362fa085de17\nAcceptable\nNA\nMissing in fsl_fcs_cat.y\n\n\n0dea8527-2ab9-4e4844-88868e-8379e514ca2b\nNA\nAcceptable\nMissing in fsl_fcs_cat.x\n\n\nda823c6f-d215-43474c-b4b0b6-6ba519748c0f\nNA\nAcceptable\nMissing in fsl_fcs_cat.x\n\n\ne76f4382-b3ea-4b404e-bebfb0-a6b2d7594c18\nAcceptable\nPoor\nDifferent results\n\n\n42698e10-7e19-4d4744-8d8b8c-04d187cb62ae\nBorderline\nNA\nMissing in fsl_fcs_cat.y\n\n\nbdc23a6e-1a35-49474b-949e9b-57bf01284ea9\nAcceptable\nNA\nMissing in fsl_fcs_cat.y\n\n\n2bd1809c-a2c1-424b44-b7b0b4-9a53b24d0e67\nBorderline\nAcceptable\nDifferent results\n\n\nde416c95-845f-4d4f40-868f8c-e12b3946ad07\nAcceptable\nNA\nMissing in fsl_fcs_cat.y\n\n\n31f4e76d-c64e-4b4144-bbb1bf-b05ca69d823e\nAcceptable\nNA\nMissing in fsl_fcs_cat.y\n\n\n\n\n\n\n\nmy_review$dataset %&gt;%\n  filter(!review_check_fsl_fcs_score.x) %&gt;%\n  select(uuid, fsl_fcs_score.x, fsl_fcs_score.y, review_comment_fsl_fcs_score.x)\n\n\n\n\n\n\n\n\n\n\nuuid\nfsl_fcs_score.x\nfsl_fcs_score.y\nreview_comment_fsl_fcs_score.x\n\n\n\nafd921c6-e54a-4c4740-919c93-87f59bd0e63a\n87.0\n46.5\nDifferent results\n\n\nc14529b6-06f7-4d4446-a1a7ac-b3648529ef7d\n61.0\n78.5\nDifferent results\n\n\n4a78b1d6-ad91-4b4f45-aba5a0-bed8cf257106\n41.5\n30.0\nDifferent results\n\n\n26bce981-8217-464d45-979a96-8a69e5371b02\n76.5\n47.5\nDifferent results\n\n\nad31fe62-5a3c-484d49-b7b8bc-a79d8304be65\n37.5\n42.5\nDifferent results",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#ejercicio-1-1",
    "href": "02-session2.html#ejercicio-1-1",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "Ejercicio 1",
    "text": "Ejercicio 1\n\nAñada la matriz de puntaje de consumo de alimentos al conjunto de datos. La matriz de consumo de alimentos es un indicador de seguridad alimentaria que utiliza el puntaje de consumo de alimentos (FCS), el puntaje de hambre en el hogar (HHS) y el índice reducido de estrategias de afrontamiento (rCSI).\n\n\n\n\n\n\n\n\n\n\n\nname\nlabel::english\ntype\n\n\n\nrCSILessQlty\nDuring the last 7 days, were there days (and, if so, how many) when your household had to rely on less preferred and less expensive food to cope with a lack of food or money to buy it?\ninteger\n\n\nrCSIBorrow\nDuring the last 7 days, were there days (and, if so, how many) when your household had to borrow food or rely on help from a relative or friend to cope with a lack of food or money to buy it?\ninteger\n\n\nrCSIMealSize\nDuring the last 7 days, were there days (and, if so, how many) when your household had to limit portion size of meals at meal times to cope with a lack of food or money to buy it?\ninteger\n\n\nrCSIMealAdult\nDuring the last 7 days, were there days (and, if so, how many) when your household had to restrict consumption by adults in order for small children to eat to cope with a lack of food or money to buy it?\ninteger\n\n\nrCSIMealNb\nDuring the last 7 days, were there days (and, if so, how many) when your household had to reduce number of meals eaten in a day to cope with a lack of food or money to buy it?\ninteger\n\n\n\n\n\n\n\nlibrary(addindicators)\nlibrary(dplyr)\n\n\nexercise_data &lt;- addindicators_MSNA_template_data %&gt;%\n  add_fcs(\n  cutoffs = \"normal\",\n  fsl_fcs_cereal = \"fs_fcs_cereals_grains_roots_tubers\",\n  fsl_fcs_legumes = \"fs_fcs_beans_nuts\",\n  fsl_fcs_veg = \"fs_fcs_vegetables_leaves\",\n  fsl_fcs_fruit = \"fs_fcs_fruit\",\n  fsl_fcs_meat = \"fs_fcs_meat_fish_eggs\",\n  fsl_fcs_dairy = \"fs_fcs_dairy\",\n  fsl_fcs_sugar = \"fs_fcs_sugar\",\n  fsl_fcs_oil = \"fs_fcs_oil_fat_butter\"\n  ) %&gt;%\n  add_hhs(\n  )\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento usar la función add_fcm_phase ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\nLa matriz de puntaje de consumo de alimentos necesita 3 indicadores: FCS, rCSI y HHS.\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Ha utilizado la variable correcta de la categoría de HHS (puntaje de hambre en el hogar)?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nmy_answer &lt;- exercise_data %&gt;% add_rcsi(\n  ) %&gt;%\n  add_fcm_phase(\n    fcs_column_name = \"fsl_fcs_cat\",\n    rcsi_column_name = \"rcsi_cat\",\n    hhs_column_name = \"hhs_cat_ipc\",\n    fcs_categories_acceptable = \"Acceptable\",\n    fcs_categories_poor = \"Poor\",\n    fcs_categories_borderline = \"Borderline\",\n    rcsi_categories_low = \"No to Low\",\n    rcsi_categories_medium = \"Medium\",\n    rcsi_categories_high = \"High\",\n    hhs_categories_none = \"None\",\n    hhs_categories_little = \"Little\",\n    hhs_categories_moderate = \"Moderate\",\n    hhs_categories_severe = \"Severe\",\n    hhs_categories_very_severe = \"Very Severe\"\n  )",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "02-session2.html#ejercicio-2-1",
    "href": "02-session2.html#ejercicio-2-1",
    "title": "02 - El marco R de IMPACT - session 2",
    "section": "Ejercicio 2",
    "text": "Ejercicio 2\n\n\nEn el siguiente conjunto de datos, debe revisar los siguientes indicadores.\n\nPuntaje de consumo de alimentos (Food Consumption Score) : fcs_score, fcs_cat\n\nPuntaje de hambre del hogar (Household Hunger Score) : hhs_score, hhs_cat\n\n\n\n\nNo olvide escribir la revisión.\n\ndataset_to_review &lt;- read.csv(\"inputs/06 - exercise - dataset_to_review.csv\")\n\ndataset_without_indicators &lt;- addindicators::addindicators_MSNA_template_data\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento usando la funcion review_variables ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Como fue definida la variable FCS ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Cómo se codificó la categoría para el HHS (puntaje de hambre en el hogar)?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nmy_review &lt;- dataset_without_indicators %&gt;% \n    add_fcs(\n  cutoffs = \"normal\",\n  fsl_fcs_cereal = \"fs_fcs_cereals_grains_roots_tubers\",\n  fsl_fcs_legumes = \"fs_fcs_beans_nuts\",\n  fsl_fcs_veg = \"fs_fcs_vegetables_leaves\",\n  fsl_fcs_fruit = \"fs_fcs_fruit\",\n  fsl_fcs_meat = \"fs_fcs_meat_fish_eggs\",\n  fsl_fcs_dairy = \"fs_fcs_dairy\",\n  fsl_fcs_sugar = \"fs_fcs_sugar\",\n  fsl_fcs_oil = \"fs_fcs_oil_fat_butter\"\n  )  %&gt;% add_hhs(\n    hhs_nofoodhh_1 = \"fs_hhs_nofood_yn\",\n    hhs_nofoodhh_1a = \"fs_hhs_nofood_freq\",\n    hhs_sleephungry_2 = \"fs_hhs_sleephungry_yn\",\n    hhs_sleephungry_2a = \"fs_hhs_sleephungry_freq\",\n    hhs_alldaynight_3 = \"fs_hhs_daynoteating_yn\",\n    hhs_alldaynight_3a = \"fs_hhs_daynoteating_freq\",\n    yes_answer = \"yes\",\n    no_answer = \"no\",\n    rarely_answer = \"rarely_1_2\",\n    sometimes_answer = \"sometimes_3_10\",\n    often_answer = \"often_10_times\"\n  ) %&gt;% \n  select(uuid, fsl_fcs_cat, fsl_fcs_score, hhs_cat, hhs_score)\ndataset_to_review &lt;- full_join(dataset_to_review, my_review, by = \"uuid\")\n\nreview &lt;- dataset_to_review %&gt;% \n  review_variables(columns_to_review = c(\"fsl_fcs_cat.x\", \"fsl_fcs_score.x\", \"hhs_cat.x\", \"hhs_score.x\"),\n                   columns_to_compare_with = c(\"fsl_fcs_cat.y\", \"fsl_fcs_score.y\", \"hhs_cat.y\", \"hhs_score.y\"))\n\nreview$review_table %&gt;% \n  group_by(variable,review_check,review_comment) %&gt;% \n  tally()\n\n\nHay 10 categorías de FCS que son diferentes.\nHay 100 categorías de HHS que son diferentes.\n\n\nreview$dataset %&gt;% \n  filter(!review_check_fsl_fcs_cat.x) %&gt;% \n  select(uuid, review_comment_fsl_fcs_cat.x, fsl_fcs_score.x, fsl_fcs_cat.x, fsl_fcs_cat.y)\n\n\n\n\n\n\n\n\n\n\n\nuuid\nreview_comment_fsl_fcs_cat.x\nfsl_fcs_score.x\nfsl_fcs_cat.x\nfsl_fcs_cat.y\n\n\n\nf1b9ec67-20db-47404d-a3ada0-1a37e5c49d02\nDifferent results\n37.5\nBorderline\nAcceptable\n\n\ne21a34f5-1a46-42404b-b7b6be-7bc9286d0f13\nDifferent results\n36.0\nBorderline\nAcceptable\n\n\n42dc8573-e2d0-43484b-aaada2-c37ef865d041\nDifferent results\n39.0\nBorderline\nAcceptable\n\n\nfcd69a08-498f-4c4b47-989799-743cbe5fd960\nDifferent results\n36.5\nBorderline\nAcceptable\n\n\n4d1cae02-49e0-484c4e-8f8d8c-a97dec246310\nDifferent results\n41.0\nBorderline\nAcceptable\n\n\na8319ceb-857c-434142-b9b8bc-7905684fc1d3\nDifferent results\n37.5\nBorderline\nAcceptable\n\n\n6d1acb45-cfb6-4b4441-87888f-e2a4756d30f9\nDifferent results\n38.0\nBorderline\nAcceptable\n\n\n0dea8527-2ab9-4e4844-88868e-8379e514ca2b\nDifferent results\n40.0\nBorderline\nAcceptable\n\n\n7e94afc5-af0b-4a4c46-bebcb7-9f60d1e53a47\nDifferent results\n37.0\nBorderline\nAcceptable\n\n\nb719ef08-bdf5-474240-858d8a-a12bc65d349e\nDifferent results\n41.5\nBorderline\nAcceptable\n\n\n\n\n\n\n\nEl puntaje de consumo de alimentos tiene diferentes categorías. ¿Qué umbrales se utilizaron para calcular el FCS? ¿Quizás 28-42?\n\n\nreview$dataset %&gt;% \n  filter(!review_check_hhs_cat.x) %&gt;% \n  select(hhs_cat.x, hhs_cat.y) %&gt;% \n  table(useNA = \"ifany\")\n\n              hhs_cat.y\nhhs_cat.x      Moderate No or Little Severe\n  moderate           29            0      0\n  no_or_little        0           58      0\n  severe              0            0     13\n\n\n\nEl HHS está bien. El etiquetado es diferente.",
    "crumbs": [
      "session 2"
    ]
  },
  {
    "objectID": "01-session1.html",
    "href": "01-session1.html",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "",
    "text": "El marco R de IMPACT se desarrollo para cumplir con los requisitos del ciclo de investigación IMPACT.  El marco es modular y tiene dos dimensiones:\n\nuna dimensión horizontal que se centra en el resultado de un cierto paso, y\nuna dimensión vertical que se centra en el contenido de un cierto paso.\n\nEl marco se basa en :\n\n\n4 etapas:\n\n\nLimpieza: cualquier manipulación necesaria para pasar de los datos brutos a los datos limpios.\n\nComposición: cualquier manipulaciòn anterior al análisis p.ej., añadir indicadores, añadir información proveniente del bucle o del dato principal , agragación por AOK, etc.\n\nAnálisis: cualquier manipulaciòn que sea relativa al análisis unicamente\n\nResultados: cualquier manipulaciòn necesaria para formatear los resultados.\n\n\n\n4 verbos:\n\n\nAdd: (añadir) funciones que añaden una nueva variable (columna) a los datos.\n\nCheck: (verificar) funciones que maracarán valores basándose en una verificación específica. Retornarán estos valores en un registro. Una función check_* devolverá una lista: el conjunto de datos verificado y el registro. La función toma un conjunto de datos como entrada y devuelve el conjunto de datos + el nuevo indicador (y cualquier paso intermedio utilizado para el cálculo).\n\nCreate: (crear) funciones que crearán o transformaran algun objecto p.ej. functiones que crearán o transformarán algun objeto creando un registro de limpieza con las verificaciones por hacer, creando una tabla de resultados del análisis etc. Las salidas de las funciones create_* pueden tener formatos diversos.\n\nReview: (revisar) funciones que revisarán un objeto comparándolo con estándares u otro objeto y señalaran las diferencias. Por ejemplo, revisando la limpieza comparando el conjunto de datos original, el conjunto de datos limpio y el registro de limplieza o comparando los resultados de dos análisis.\n\n\n** 2 adjetivos**:\n\n\nPipe-able: (encadenable) En el marco, las funciones de la misma familia son encadenables (es decir, se pueden aplicar una después de la otra). En el siguiento ejemplo, se encadenan dos funciones check_*.\n\nIndependiente: En cualquier paso dado, el usuario puede cambiar de herramienta. Cada entrada y cada salida de un paso deben seguir el mismo formato y definición.\n\n\n\nEl objetivo es que este conjunto de elementos ayude a la cooperación y colaboración entre diferentes equipos. Las herramientas presentes en este marco deben ser adaptables a cada contexto y evaluación.",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#check_outliers",
    "href": "01-session1.html#check_outliers",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "check_outliers",
    "text": "check_outliers\n\nmy_log1 &lt;- my_raw_dataset %&gt;% \n  check_outliers(uuid_column = \"X_uuid\")\n\nEn este ejemplo, la salida será:\n\n\nchecked_dataset: el conjunto de datos original (con variables adicionales si es necesario)\n\npotential_outliers: un registro de posibles valores atípicos.\n\n\ntypeof(my_log1)\n\n[1] \"list\"\n\nmy_log1 %&gt;% \n  names()\n\n[1] \"checked_dataset\"    \"potential_outliers\"\n\n\nEl registro tiene al menos 4 columnas:\n\n\nuuid: el identificador único de la encuesta\n\nissue: el problema que se esta señalando\n\nquestion: el nombre de la variable en el conjunto de datos\n\nold_value: el valor que se está señalando\n\n\nmy_log1$potential_outliers %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\nuuid\nissue\nquestion\nold_value\n\n\n\nb5b1d37a-e27a-4c35-a0f5-2cde9d6dfd06\noutlier (normal distribution)\nage_respondent_r\n86\n\n\n956b5ed0-5a62-41b7-aec3-af93fbc5b494\noutlier (normal distribution)\nage_respondent_r\n84\n\n\n97ad6294-30c6-454e-a0b3-42126415b767\noutlier (log distribution)\nage_respondent_r\n18\n\n\ne005e719-57c4-44a3-ac2f-5d6d1ff68831\noutlier (log distribution)\nage_respondent_r\n18\n\n\nc9aaa542-118f-4e42-93de-fb0916572541\noutlier (normal distribution)\nnum_hh_member\n19\n\n\n48e8896b-d1be-4600-8839-2d8b994ebcfb\noutlier (normal distribution)\nnum_hh_member\n19\n\n\n\n\n\n\n\n\n\n\n\n\n\nNota\n\n\n\nSe considerán como atípicos valores con +/- 3 deviaciones estándar de la media.\nSi asumimos una distribución logarítmica, utilizamos la función log(x + 1).",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#check_duplicate",
    "href": "01-session1.html#check_duplicate",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "check_duplicate",
    "text": "check_duplicate\n\nmy_log2 &lt;- my_raw_dataset %&gt;% \n  check_duplicate(uuid_column = \"X_uuid\")\n\nmy_log2$duplicate_log %&gt;% \n  head()\n\n\n\n\nuuid\nold_value\nquestion\nissue\n\n\n\n\n\n\nDado que no hay duplicados, el registro está vacío.",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#pipe-able",
    "href": "01-session1.html#pipe-able",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Pipe-able",
    "text": "Pipe-able\n\n\n\n\n\n\nPipe-able\n\n\n\nEl marco se basa en 2 adjetivos, pipe-able e independiente. En el marco, las funciones de la misma familias deben ser encadenables (pipeable). En el siguiente caso, se encadenan 2 funciones check_*.\n\n\n\nmy_log3 &lt;- my_raw_dataset %&gt;% \n  check_outliers(uuid_column = \"X_uuid\") %&gt;% \n  check_duplicate(uuid_column = \"X_uuid\")\n\n\nnames(my_log3)\n\n[1] \"checked_dataset\"    \"potential_outliers\" \"duplicate_log\"     \n\n\n\nmy_log3$potential_outliers %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\nuuid\nissue\nquestion\nold_value\n\n\n\nb5b1d37a-e27a-4c35-a0f5-2cde9d6dfd06\noutlier (normal distribution)\nage_respondent_r\n86\n\n\n956b5ed0-5a62-41b7-aec3-af93fbc5b494\noutlier (normal distribution)\nage_respondent_r\n84\n\n\n97ad6294-30c6-454e-a0b3-42126415b767\noutlier (log distribution)\nage_respondent_r\n18\n\n\ne005e719-57c4-44a3-ac2f-5d6d1ff68831\noutlier (log distribution)\nage_respondent_r\n18\n\n\nc9aaa542-118f-4e42-93de-fb0916572541\noutlier (normal distribution)\nnum_hh_member\n19\n\n\n48e8896b-d1be-4600-8839-2d8b994ebcfb\noutlier (normal distribution)\nnum_hh_member\n19\n\n\n\n\n\n\n\nmy_log3$duplicate_log %&gt;% \n  head()\n\n\n\n\nuuid\nold_value\nquestion\nissue",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#verificaciones-adicionales",
    "href": "01-session1.html#verificaciones-adicionales",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Verificaciones adicionales",
    "text": "Verificaciones adicionales\nEste es un ejemplo de verificaciones adicionales que existen.\n\nmore_logs &lt;- my_raw_dataset %&gt;% \n  check_duplicate(uuid_column = \"X_uuid\") %&gt;% \n  check_soft_duplicates(uuid_column = \"X_uuid\", kobo_survey = my_kobo_survey, sm_separator = \".\") %&gt;%\n  check_outliers(uuid_column = \"X_uuid\") %&gt;%\n  check_value(uuid_column = \"X_uuid\")",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#add_duration",
    "href": "01-session1.html#add_duration",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "add_duration",
    "text": "add_duration\n\n\n\n\n\n\nadd_*\n\n\n\n\nLas funciones add_* añadirán una variable (columna) al conjunto de datos. Por ejemplo, añadirán la duración de una encuesta, añadiran la categoría de puntaje de consumo de alimentos, etc.\nUna funcion add_* toma un conjunto de datos como entrada y devuelve el conjunto de datos + el nuevo indicador (y cualquier paso intermedia utilizado para el cálculo).\nEn el ejemplo siguiento, se usa la funcion add_duration para añadir la duración de la encuesta usando el tiempo de inicio y de fin.\n\n\n\nmore_logs$checked_dataset &lt;- more_logs$checked_dataset %&gt;% \n  add_duration(uuid_column = \"X_uuid\", start_column = \"X.U.FEFF.start\", end_column = \"end\")\nmore_logs$checked_dataset[1:6, c(\"start_date\", \"start_time\", \"end_date\", \"end_time\", \"days_diff\", \"duration\")]\n\n\n\n\n\n\n\n\n\n\n\n\nstart_date\nstart_time\nend_date\nend_time\ndays_diff\nduration\n\n\n\n2021-07-05\n658.57 mins\n2021-07-05\n696.68 mins\n0 days\n38.11\n\n\n2021-07-05\n608.90 mins\n2021-07-05\n641.92 mins\n0 days\n33.02\n\n\n2021-07-05\n682.23 mins\n2021-07-05\n726.43 mins\n0 days\n44.20\n\n\n2021-07-04\n1342.98 mins\n2021-07-04\n1380.15 mins\n0 days\n37.17\n\n\n2021-07-04\n1391.62 mins\n2021-07-05\n18.88 mins\n1 days\n67.26\n\n\n2021-07-05\n617.38 mins\n2021-07-05\n756.52 mins\n0 days\n139.14\n\n\n\n\n\n\n\n\n\n\n\n\n\nAdvertencia\n\n\n\nLa duración se añade a checked_dataset en la lista, no a my_raw_dataset. Las funciones check_* se utilizan en cadena, por lo cual es necesario que el conjunto actual de datos sea modificado.\n\n\n\n\n\n\n\nAdvertencia\n\n\n\nEn este momento, la funcion add_duration acepta solo un formato muy específico. En el futuro, cambiará para volverse màs robusta y se harà usando lubridate.\n\n\ncheck_duration se puede utilizar en cadena con las verificaciones anteriores.\n\nmore_logs &lt;- more_logs %&gt;% \n  check_duration(column_to_check = \"duration\", uuid_column = \"X_uuid\")\n\nEn la medida de lo posible, las funciones check_* toman argumentos predeterminados o infieren la información necesaria, p.ej. la funcion check_outliers infiere que columnas contienen valores numericos. Ciertas funciones requieren mãs informaciòn.",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#columnas-de-texto",
    "href": "01-session1.html#columnas-de-texto",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Columnas de texto",
    "text": "Columnas de texto\nLa funcion check_other necesita la lista de columnas que se deben verificar. Al momento, no es capaz de detectar preguntas de texto abierto. Se puede utilizar la herramienta KOBO.\n\nother_columns_to_check &lt;- my_kobo_survey %&gt;% \n  dplyr::filter(type == \"text\") %&gt;% \n  dplyr::filter(name %in% names(my_raw_dataset)) %&gt;%\n  dplyr::pull(name) \n\nmore_logs &lt;- more_logs %&gt;% \n  check_others(uuid_column = \"X_uuid\", columns_to_check = other_columns_to_check)",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#check_logical_with_list",
    "href": "01-session1.html#check_logical_with_list",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "check_logical_with_list",
    "text": "check_logical_with_list\nEn otros casos, la verificación es específica y debe ser adaptada al conjunto de datos. Es el caso de la función check_logical_with_list, a la cual se le puede dar como entrada una tabla de Excel con las verificaciones lógicas por aplicar.\n\nlogical_check_list &lt;- readxl::read_excel(\"inputs/01 - example - check_list.xlsx\")\nlogical_check_list\n\n\n\n\n\n\n\n\n\n\ncheck_id\ndescription\ncheck_to_perform\ncolumns_to_clean\n\n\n\ncheck_1\nprimary_livelihood is employment but expenses less than 200000\nprimary_livelihood.employment == 1 & tot_expenses &lt; 200000\nprimary_livelihood.employment,\n\n\ntot_expenses\n\n\n\n\n\ncheck_2\nacces water and tank emptied\naccess_water_enough == “totally_insufficient” & tank_emptied == “about_half”\naccess_water_enough, tank_emptied\n\n\n\n\n\n\nLa entrada, es decir, la tabla de Excel con las verificaciones lógicas, debe tener 4 columnas:\n\ncheck_id : el nombre de la verificación\ndescription : la descripcion de la verificacion\ncheck_to_perform : la verificación por hacer. El formato de la verificación por hacer debe ser compatible con tidyverse. Se debe usar un formato similar al que se utilizaría en la función mutate para crear un nuevo indicador lógico (es decir, TRUE o FALSE). La verificación lógica debe estar escrita de manera que la salida TRUE corresponda a la encuesta que se quiera señalar.\ncolumns_to_clean : la lista de columnas utilizadas para la verificación lógica.\n\nUna tal lista se puede utilizar con check_logical_with_list.\n\nexample_logic &lt;- my_raw_dataset %&gt;% \n  check_logical_with_list(uuid_column = \"X_uuid\",\n                          list_of_check = logical_check_list,\n                          check_id_column = \"check_id\",\n                          check_to_perform_column = \"check_to_perform\",\n                          columns_to_clean_column = \"columns_to_clean\",\n                          description_column = \"description\")\n\n\nexample_logic$logical_all %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\n\n\nuuid\nquestion\nold_value\nissue\ncheck_id\ncheck_binding\n\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\nprimary_livelihood.employment\nTRUE\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / f1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\n\n\nf1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\ntot_expenses\n125000\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / f1175d29-ce1f-43a7-b3d1-ee26cd1b8cdb\n\n\ne9f8b44c-c507-45a1-8d76-66d886437b8f\nprimary_livelihood.employment\nTRUE\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / e9f8b44c-c507-45a1-8d76-66d886437b8f\n\n\ne9f8b44c-c507-45a1-8d76-66d886437b8f\ntot_expenses\n175000\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / e9f8b44c-c507-45a1-8d76-66d886437b8f\n\n\n994a60b8-e640-425c-9774-160651d7af04\nprimary_livelihood.employment\nTRUE\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / 994a60b8-e640-425c-9774-160651d7af04\n\n\n994a60b8-e640-425c-9774-160651d7af04\ntot_expenses\n175000\nprimary_livelihood is employment but expenses less than 200000\ncheck_1\ncheck_1 / 994a60b8-e640-425c-9774-160651d7af04\n\n\n\n\n\n\nEl registro que se obtiene contiene las siguientes columnas:\n\nuuid: el identificador único de la encuesta\nquestion: el nombre de la columna señalada, sera un elemento de la lista columns_to_clean\n\nold value: el valor en la columna de columns_to_clean señalada\nissue: el problema señalado\ncheck_id: el identificador de la verificación lógica\ncheck_binding: una combinación del check_id y del uuid.\n\nPara una verificación dada, el registro tendrá varias líneas relativas al mismo señalamiento. En el ejemplo anterior, para cada uuid, los valores de las columnas primary_livelihood y tot_expenses son señalados (una línea por cada uuid por cada columna en columns_to_clean).\nEl formato de la verificación por hacer debe ser compatible con tidyverse. Se debe usar un formato similar al que se utilizaría en la función mutate para crear un nuevo indicador lógico (es decir, TRUE o FALSE). La verificación lógica debe estar escrita de manera que la salida TRUE corresponda a la encuesta que se quiera señalar.\n\nmy_raw_dataset %&gt;% \n  dplyr::mutate(xxx =  primary_livelihood.employment == 1 & tot_expenses &lt; 200000) %&gt;% \n  dplyr::select(X_uuid, xxx, primary_livelihood.employment, tot_expenses) %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\nX_uuid\nxxx\nprimary_livelihood.employment\ntot_expenses\n\n\n\ndcf2753a-6ea2-40f5-b493-3527931ef96c\nFALSE\nFALSE\n250000\n\n\n8790ce5c-1c35-41a2-b3c0-538f937d5397\nFALSE\nTRUE\n750000\n\n\nbb818e04-9c40-408e-919f-6b40ff1fdbb3\nFALSE\nFALSE\n250000\n\n\n28b90cbb-2cf0-41c5-9ee1-1c719c0d4c02\nFALSE\nTRUE\n600000\n\n\n7f2a0c6a-529b-481f-963f-a96dca2ec034\nFALSE\nTRUE\n500000\n\n\nb4f92064-12ea-4970-b0f5-fd309de1dda3\nFALSE\nFALSE\n650000\n\n\n\n\n\n\nEl conjunto de datos verificado incluirá columnas adicionales. Estas columnas tendrán el nombre del check_id y contendrán valores lógicos.\n\nexample_logic$checked_dataset[1:6,tail(names(example_logic$checked_dataset))]\n\n\n\n\nX_notes\nX_status\nX_submitted_by\nX_index\ncheck_1\ncheck_2\n\n\n\n[]\nsubmitted_via_web\nreach_irq\n1\nFALSE\nFALSE\n\n\n[]\nsubmitted_via_web\nreach_irq\n2\nFALSE\nFALSE\n\n\n[]\nsubmitted_via_web\nreach_irq\n3\nFALSE\nFALSE\n\n\n[]\nsubmitted_via_web\nreach_irq\n4\nFALSE\nFALSE\n\n\n[]\nsubmitted_via_web\nreach_irq\n5\nFALSE\nFALSE\n\n\n[]\nsubmitted_via_web\nreach_irq\n6\nFALSE\nFALSE\n\n\n\n\n\n\n\n\n\n\n\n\n\nNota\n\n\n\nSi no se incluya la lista columns_to_clean la funcion check_logical_with_list intentará identificar las variables de forma automática. Sin embargo, no se puede garantizar que seleccione los nombres correctos.",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#ejercicio-1",
    "href": "01-session1.html#ejercicio-1",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Ejercicio 1",
    "text": "Ejercicio 1\nProbar lo siguiente con un conjunto de datos:\n\nRealiza una verificación para detectar información de identificación personal.\n\n\nlibrary(cleaningtools)\nlibrary(dplyr)\n\nmy_raw_dataset &lt;- cleaningtools::cleaningtools_raw_data\nmy_kobo_survey &lt;- cleaningtools::cleaningtools_survey\nmy_kobo_choice &lt;- cleaningtools::cleaningtools_choices\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\nPruebe con la función check_pii\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nmy_raw_dataset %&gt;% \n  check_pii(uuid_column = \"X_uuid\")",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#ejercicio-2",
    "href": "01-session1.html#ejercicio-2",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Ejercicio 2",
    "text": "Ejercicio 2\n\nRealize una verificación que examine los porcentajes de valores faltantes por encuesta y que señale cualquier observación atípica.\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\nPruebe con la función check_percentage_missing\n\n\n\n\n\n\n\n\n\nHaga clic para ver una pista.\n\n\n\n\n\n¿Intento añadir una nueva columna con add_percentage_missing ?\n\n\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nmy_raw_dataset &lt;- my_raw_dataset %&gt;% \n  add_percentage_missing(kobo_survey = my_kobo_survey)\n  \nmy_raw_dataset %&gt;% \n  check_percentage_missing(uuid_column = \"X_uuid\")\n\nSi ya estás utilizando un registro\n\nmore_logs$checked_dataset &lt;- more_logs$checked_dataset %&gt;% \n  add_percentage_missing(kobo_survey = my_kobo_survey)\nmore_logs %&gt;% \n  check_percentage_missing(uuid_column = \"X_uuid\")",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#ejercicio-3",
    "href": "01-session1.html#ejercicio-3",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Ejercicio 3",
    "text": "Ejercicio 3\n\nComplete una tabla Excel para realizar las siguientes verificaciones lógicas :\n\nEl número de miembros del hogar (variable: num_hh_member) es superior a 8.\nLa fuente de agua para beber es agua embotellada (variable: water_source_drinking, value: bottled) y el hogar siempre trata el agua (variable: treat_drink_water, value: always_treat).\nLa fuente de agua para beber es agua embotellada (variable: water_source_drinking, value: bottled) y una de las principales razones por las que el hogar no satisface sus nececidades de agua es la presión del agua (variable: access_water_enough_why_not, value: water_pressure, this is a select multiple)\n\n\n\n\n\n\n\n\n\n\n\n\n\nname\nlabel::English (en)\ntype\n\n\n\nnum_hh_member\nHow many members are there in your household (including you)?\ninteger\n\n\nwater_source_drinking\nWhat is the main source of water used by your household for drinking?\nselect_one water_sources\n\n\ntreat_drink_water\nDoes your household treat this water in any way to make it safer to drink?\nselect_one treat\n\n\naccess_water_enough_why_not\nWhat are the main reasons your household is not able to meet its water needs?\nselect_multiple barriers_water_needs\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nname\nlabel::English (en)\nlist_name\n\n\n\nbottled\nBottled or sachet water\nwater_sources\n\n\nalways_treat\nYes, always treat it before drinking\ntreat\n\n\nwater_pressure\nWater pressure is not high enough/pumps required\nbarriers_water_needs\n\n\n\n\n\n\n\nexercise_check_list &lt;- readxl::read_excel(\"inputs/01 - example - check_list.xlsx\")\n\nmy_raw_dataset %&gt;% \n    check_logical_with_list(uuid_column = \"X_uuid\",\n                          list_of_check = exercise_check_list,\n                          check_id_column = \"check_id\",\n                          check_to_perform_column = \"check_to_perform\",\n                          columns_to_clean_column = \"columns_to_clean\",\n                          description_column = \"description\")\n\n\n\n\n\n\n\nHaga clic para ver la respuesta.\n\n\n\n\n\n\nmy_check_list &lt;- data.frame(check_id = c(\"check_household number\", \"check_water_treatment\", \"check_3\"),\n                            description = c(\"num_hh_member is big\",\"using bottled water and always treat\",\"using bottled water and main reason is water pressure\"),\n                            check_to_perform = c(\"num_hh_member &gt; 8\",\"water_source_drinking == \\\"bottled\\\" & treat_drink_water == \\\"always_treat\\\"\",\"water_source_drinking == \\\"bottled\\\" & access_water_enough_why_not.water_pressure == TRUE\"),\n                            columns_to_clean = c(\"num_hh_member\",\"water_source_drinking, treat_drink_water\",\"water_source_drinking, access_water_enough_why_not.water_pressure\"))\n\nmy_raw_dataset %&gt;% \n    check_logical_with_list(uuid_column = \"X_uuid\",\n                          list_of_check = my_check_list,\n                          check_id_column = \"check_id\",\n                          check_to_perform_column = \"check_to_perform\",\n                          columns_to_clean_column = \"columns_to_clean\",\n                          description_column = \"description\")",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "01-session1.html#ejercicio-adicional",
    "href": "01-session1.html#ejercicio-adicional",
    "title": "01 - El marco R de IMPACT - session 1",
    "section": "Ejercicio adicional",
    "text": "Ejercicio adicional\n\nIntente añadir la duración con los archivos de auditoría (es decir, los audit files de la herramienta KOBO).\n\n\n\n\n\n\n\nHaga clic para ver una clave.\n\n\n\n\n\nPruebe usando las funciones create_audit_list() y add_duration_from_audit()",
    "crumbs": [
      "session 1"
    ]
  },
  {
    "objectID": "04-session4.html",
    "href": "04-session4.html",
    "title": "04 - R framework with IMPACT - session 4",
    "section": "",
    "text": "library(analysistools)\nlibrary(dplyr)\n\nmy_data &lt;- analysistools::analysistools_MSNA_template_data\n\nsampling_frame &lt;- data.frame(\n  strata = c(\"admin1a\", \"admin1b\", \"admin1c\"),\n  population = c(100000, 200000, 300000)\n)\n\nmy_data &lt;- my_data %&gt;% \n  add_weights(sampling_frame, \"admin1\", \"strata\", \"population\")\n\nmy_loa &lt;- analysistools::analysistools_MSNA_template_loa\n\nmy_design &lt;- srvyr::as_survey_design(my_data, weights = \"weights\", strata = \"admin1\")\nmy_results &lt;- create_analysis(my_design, loa = my_loa, sm_separator = \"/\")",
    "crumbs": [
      "session 4"
    ]
  },
  {
    "objectID": "04-session4.html#create__group_x_variable",
    "href": "04-session4.html#create__group_x_variable",
    "title": "04 - R framework with IMPACT - session 4",
    "section": "create_*_group_x_variable",
    "text": "create_*_group_x_variable\nWide table with the groups in the rows and the variables in the columns.\n\nmy_results_table %&gt;% \n  create_table_group_x_variable() %&gt;% \n  create_xlsx_group_x_variable(file_path = \"outputs/04 - example - group_x_variable.xlsx\", overwrite = T)",
    "crumbs": [
      "session 4"
    ]
  },
  {
    "objectID": "04-session4.html#create__variable_x_group",
    "href": "04-session4.html#create__variable_x_group",
    "title": "04 - R framework with IMPACT - session 4",
    "section": "create_*_variable_x_group",
    "text": "create_*_variable_x_group\nWide table with the variables in the rows and the groups in the columns.\n\nmy_results_table %&gt;% \n  create_table_variable_x_group() %&gt;%\n  create_xlsx_variable_x_group(file_path = \"outputs/05 - example - variable_x_group.xlsx\", overwrite = T)",
    "crumbs": [
      "session 4"
    ]
  },
  {
    "objectID": "04-session4.html#exercise-1",
    "href": "04-session4.html#exercise-1",
    "title": "04 - R framework with IMPACT - session 4",
    "section": "Exercise 1",
    "text": "Exercise 1\n\nCreate an excel table with the strata in the rows and the variables in the columns.\n\n\nlibrary(presentresults)\n\n\nexercise_outputs &lt;- readxl::read_excel(\"inputs/10 - exercise - analysis_to_review.xlsx\")\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nexercise_outputs %&gt;% \n  create_table_group_x_variable() %&gt;% \n  create_xlsx_group_x_variable(file_path = \"outputs/06 - correction - group_x_variable_table.xlsx\", overwrite = T)",
    "crumbs": [
      "session 4"
    ]
  },
  {
    "objectID": "04-session4.html#exercise-2",
    "href": "04-session4.html#exercise-2",
    "title": "04 - R framework with IMPACT - session 4",
    "section": "Exercise 2",
    "text": "Exercise 2\n\nTry the tabular html output.\nTry to edit the authors, RCID and the introduction.",
    "crumbs": [
      "session 4"
    ]
  },
  {
    "objectID": "03-session3.html",
    "href": "03-session3.html",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "",
    "text": "library(addindicators)\nlibrary(dplyr)"
  },
  {
    "objectID": "03-session3.html#create_analysis",
    "href": "03-session3.html#create_analysis",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "create_analysis",
    "text": "create_analysis\nAny create_analysis_* function will need a survey to be used, not a dataset. A survey object will be defined with the weights, strata and cluster information if they exists.\n\n\n\n\n\n\ncreate_*\n\n\n\n\ncreate_* functions will create, transform something, e.g. creating a cleaning log with the checks to be filled, create analysis results table, create an output.\nOutputs from create_* functions outputs can be in different shape, format, etc.\ncreate_* function is catch-all.\n\n\n\nlibrary(analysistools)\nlibrary(dplyr)\n\n\nonly_nas &lt;- my_data_with_indicators %&gt;%\n  summarise(across(.cols = everything(), .fns = function(x) {\n    sum(is.na(x)) == nrow(my_data_with_indicators)\n  })) %&gt;%\n  do.call(c, .)\n\nmy_data_shorter &lt;- my_data_with_indicators[, !only_nas] %&gt;%\n  select(!grep(\"other\", names(my_data_with_indicators), value = T))\n\n\n\n\n\n\n\n\nNota\n\n\n\nAt the moment, create_analysis breaks where a column only have missing values. They need to be removed beforehand.\n\n\nmy_design &lt;- srvyr::as_survey_design(my_data_shorter, strata = \"admin1\")\n\nmy_analysis &lt;- create_analysis(my_design, sm_separator = \"/\")\n\n\n\n\n\n\n\n\nNota\n\n\n\ncreate_analysis uses a survey design, not a dataset. Survey design object contains the information on the design of the survey, such as stratas, cluster, weights. It is built with srvyr package which is a wrapper around survey package.\n\ncreate_analysis returns a list with:\n\nResults table: a long table with summary statistics per line\nDataset: the dataset used with the survey design\nList of analysis: all the analysis that were performed\n\n\nmy_analysis %&gt;%\n  names()\n\n[1] \"results_table\" \"dataset\"       \"loa\"          \n\n\n\nmy_analysis$results_table %&gt;%\n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nanalysis_var_value\ngroup_var\ngroup_var_value\nstat\nstat_low\nstat_upp\nn\nn_total\nn_w\nn_w_total\nanalysis_key\n\n\n\nprop_select_one\nenum_gender\nfemale\nNA\nNA\n0.33\n0.2356238\n0.4243762\n33\n100\n33\n100\nprop_select_one @/@ enum_gender %/% female @/@ NA %/% NA\n\n\nprop_select_one\nenum_gender\nmale\nNA\nNA\n0.29\n0.1989592\n0.3810408\n29\n100\n29\n100\nprop_select_one @/@ enum_gender %/% male @/@ NA %/% NA\n\n\nprop_select_one\nenum_gender\nother\nNA\nNA\n0.38\n0.2829941\n0.4770059\n38\n100\n38\n100\nprop_select_one @/@ enum_gender %/% other @/@ NA %/% NA\n\n\nprop_select_one\nhoh\nno\nNA\nNA\n0.50\n0.3995960\n0.6004040\n50\n100\n50\n100\nprop_select_one @/@ hoh %/% no @/@ NA %/% NA\n\n\nprop_select_one\nhoh\nyes\nNA\nNA\n0.50\n0.3995960\n0.6004040\n50\n100\n50\n100\nprop_select_one @/@ hoh %/% yes @/@ NA %/% NA\n\n\nprop_select_one\nrespondent_able_to_answer\nno\nNA\nNA\n0.57\n0.4736852\n0.6663148\n57\n100\n57\n100\nprop_select_one @/@ respondent_able_to_answer %/% no @/@ NA %/% NA\n\n\n\n\n\n\n\nmy_analysis$loa %&gt;%\n  head()\n\n\n\n\nanalysis_type\nanalysis_var\ngroup_var\nlevel\n\n\n\nprop_select_one\nenum_gender\nNA\n0.95\n\n\nprop_select_one\nhoh\nNA\n0.95\n\n\nprop_select_one\nrespondent_able_to_answer\nNA\n0.95\n\n\nmean\nrespondent_age\nNA\n0.95\n\n\nmedian\nrespondent_age\nNA\n0.95\n\n\nprop_select_one\nrespondent_gender\nNA\n0.95"
  },
  {
    "objectID": "03-session3.html#exercise-1",
    "href": "03-session3.html#exercise-1",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "Exercise 1",
    "text": "Exercise 1\n\nlibrary(analysistools)\n\n\nexercise_data &lt;- analysistools_MSNA_template_data\n\nonly_nas &lt;- exercise_data %&gt;%\n  summarise(across(.cols = everything(), .fns = function(x) {\n    sum(is.na(x)) == nrow(exercise_data)\n  })) %&gt;%\n  do.call(c, .)\n\nexercise_data_shorter &lt;- exercise_data[, !only_nas] %&gt;%\n  select(!grep(\"other\", names(exercise_data), value = T))\n\nWith the dataset exercise_data, please do the following:\n\nCreate a results table at the level respondent_gender. Keep the strata at admin1\n\n\n\n\n\n\n\n\nExpand to get a hint\n\n\n\n\n\nDid you try the argument group_var in create_analysis ?\n\n\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nmy_exercise_design &lt;- srvyr::as_survey_design(exercise_data_shorter, strata = \"admin1\") \n\nmy_answer_analysis &lt;- create_analysis(my_exercise_design, group_var = \"respondent_gender\", sm_separator = \"/\")"
  },
  {
    "objectID": "03-session3.html#exercise-2",
    "href": "03-session3.html#exercise-2",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "Exercise 2",
    "text": "Exercise 2\n\nThe analysis should be weighted, this is the sampling frame. Re-do the analysis at the overall level.\n\n\nsampling_frame &lt;- data.frame(\n  strata = c(\"admin1a\", \"admin1b\", \"admin1c\"),\n  population = c(100000, 200000, 300000)\n)\nsampling_frame\n\n\n\n\nstrata\npopulation\n\n\n\nadmin1a\n1e+05\n\n\nadmin1b\n2e+05\n\n\nadmin1c\n3e+05\n\n\n\n\n\n\n\n\n\n\n\n\nExpand to get a hint\n\n\n\n\n\nDid you try the function add_weights ?\n\n\n\n\n\n\n\n\n\nExpand to get a hint\n\n\n\n\n\nDid you modify your design object?\n\n\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nexercise_data_shorter_weigthed &lt;- exercise_data_shorter %&gt;% \n  add_weights(sample_data = sampling_frame, strata_column_dataset = \"admin1\", strata_column_sample = \"strata\", population_column = \"population\")\n\nmy_exercise_design_weigthed &lt;- srvyr::as_survey_design(exercise_data_shorter_weigthed, strata = \"admin1\", weights = \"weights\") \n\nmy_answer_analysis_weighted &lt;- create_analysis(my_exercise_design_weigthed, sm_separator = \"/\")\n\n\n\n\n\nlibrary(analysistools)\nlibrary(dplyr)\n\nmy_data &lt;- analysistools::analysistools_MSNA_template_data\n\nsampling_frame &lt;- data.frame(\n  strata = c(\"admin1a\", \"admin1b\", \"admin1c\"),\n  population = c(100000, 200000, 300000)\n)\n\nset.seed(1323)\nmy_data &lt;- my_data |&gt;\n  mutate(num_aged_school_children = round(runif(100, min = 0, max = 5)),\n         num_enrolled_school_children = round(runif(100, min = 0, max = 5)),\n         num_enrolled_school_children = case_when(num_aged_school_children == 0 ~ NA, num_aged_school_children &lt; num_enrolled_school_children ~ num_aged_school_children,\n                                                  TRUE ~ num_enrolled_school_children\n                                                  ))"
  },
  {
    "objectID": "03-session3.html#create_analysis-and-list-of-analysis-loa",
    "href": "03-session3.html#create_analysis-and-list-of-analysis-loa",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "\ncreate_analysis and list of analysis (loa)",
    "text": "create_analysis and list of analysis (loa)\nList of analysis (loa) is a list with all analysis to be performed. It takes the form of a data frame with minimum 4 columns:\n\n\nanalysis_type : The analysis type that should be performed.\n\nanalysis_var : The analysis variable or dependent variable.\n\ngroup_var : The grouping variable or independent variable.\n\nlevel : The confidence level (expressed between 0 and 1).\n\n\nmy_loa &lt;- analysistools::analysistools_MSNA_template_loa\n\nmy_loa\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\ngroup_var\nlevel\n\n\n\nprop_select_one\nadmin1\nNA\n0.95\n\n\nmean\nincome_v1_salaried_work\nNA\n0.95\n\n\nmedian\nincome_v1_salaried_work\nNA\n0.95\n\n\nmean\nexpenditure_debt\nNA\n0.95\n\n\nmedian\nexpenditure_debt\nNA\n0.95\n\n\nprop_select_one\nwash_drinkingwatersource\nNA\n0.95\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nNA\n0.95\n\n\nmean\nincome_v1_salaried_work\nadmin1\n0.95\n\n\nmedian\nincome_v1_salaried_work\nadmin1\n0.95\n\n\nmean\nexpenditure_debt\nadmin1\n0.95\n\n\nmedian\nexpenditure_debt\nadmin1\n0.95\n\n\nprop_select_one\nwash_drinkingwatersource\nadmin1\n0.95\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nadmin1\n0.95\n\n\n\n\n\n\nThe loa can be passed as argument to the create_analysis function.\n\nmy_data &lt;- my_data %&gt;% \n  add_weights(sampling_frame, \"admin1\", \"strata\", \"population\")\n\nmy_design &lt;- srvyr::as_survey_design(my_data, weights = \"weights\", strata = \"admin1\")\nmy_results &lt;- create_analysis(my_design, loa = my_loa, sm_separator = \"/\")\n\n\nhead_results_table &lt;- my_results$results_table %&gt;% \n  head(5)\n\ntail_results_table &lt;- my_results$results_table %&gt;% \n  tail(5)\n\nrbind(head_results_table,tail_results_table)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nanalysis_var_value\ngroup_var\ngroup_var_value\nstat\nstat_low\nstat_upp\nn\nn_total\nn_w\nn_w_total\nanalysis_key\n\n\n\nprop_select_one\nadmin1\nadmin1a\nNA\nNA\n0.1666667\n0.1666667\n0.1666667\n31\n100\n16.66667\n100\nprop_select_one @/@ admin1 %/% admin1a @/@ NA %/% NA\n\n\nprop_select_one\nadmin1\nadmin1b\nNA\nNA\n0.3333333\n0.3333333\n0.3333333\n27\n100\n33.33333\n100\nprop_select_one @/@ admin1 %/% admin1b @/@ NA %/% NA\n\n\nprop_select_one\nadmin1\nadmin1c\nNA\nNA\n0.5000000\n0.5000000\n0.5000000\n42\n100\n50.00000\n100\nprop_select_one @/@ admin1 %/% admin1c @/@ NA %/% NA\n\n\nmean\nincome_v1_salaried_work\nNA\nNA\nNA\n20.0472777\n19.6448025\n20.4497529\n100\n100\n100.00000\n100\nmean @/@ income_v1_salaried_work %/% NA @/@ NA %/% NA\n\n\nmedian\nincome_v1_salaried_work\nNA\nNA\nNA\n20.0000000\n20.0000000\n21.0000000\n100\n100\n100.00000\n100\nmedian @/@ income_v1_salaried_work %/% NA @/@ NA %/% NA\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nunreliable_technology\nadmin1\nadmin1c\n0.5000000\n0.3450192\n0.6549808\n21\n42\n25.00000\n50\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% unreliable_technology @/@ admin1 %/% admin1c\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nlack_equipment\nadmin1\nadmin1c\n0.5714286\n0.4180373\n0.7248198\n24\n42\n28.57143\n50\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% lack_equipment @/@ admin1 %/% admin1c\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nother\nadmin1\nadmin1c\n0.4047619\n0.2526185\n0.5569053\n17\n42\n20.23810\n50\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% other @/@ admin1 %/% admin1c\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\ndont_know\nadmin1\nadmin1c\n0.5000000\n0.3450192\n0.6549808\n21\n42\n25.00000\n50\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% dont_know @/@ admin1 %/% admin1c\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nprefer_not_to_answer\nadmin1\nadmin1c\n0.4285714\n0.2751802\n0.5819627\n18\n42\n21.42857\n50\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% prefer_not_to_answer @/@ admin1 %/% admin1c"
  },
  {
    "objectID": "03-session3.html#create_analysis_ratio",
    "href": "03-session3.html#create_analysis_ratio",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "create_analysis_ratio",
    "text": "create_analysis_ratio\nTo calculate ratio, there are two functions create_analysis_ratio or create_analysis with a loa with more information.\n\nmy_loa_with_ratio &lt;- read.csv(\"inputs/07 - example - loa_with_ratio.csv\")\n\n\nmy_loa_with_ratio %&gt;% \n  filter(analysis_type == \"ratio\") |&gt;\n  select(analysis_type, analysis_var, group_var, analysis_var_numerator, analysis_var_denominator)\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\ngroup_var\nanalysis_var_numerator\nanalysis_var_denominator\n\n\n\nratio\nNA\nNA\nnum_enrolled_school_children\nnum_aged_school_children\n\n\nratio\nNA\nadmin1\nnum_enrolled_school_children\nnum_aged_school_children\n\n\n\n\n\n\n\nmy_results_with_ratio &lt;- create_analysis(my_design, loa = my_loa_with_ratio, sm_separator = \"/\")\n\n\nmy_results_with_ratio$results_table %&gt;% \n  filter(analysis_type == \"ratio\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nanalysis_var_value\ngroup_var\ngroup_var_value\nstat\nstat_low\nstat_upp\nn\nn_total\nn_w\nn_w_total\nanalysis_key\n\n\n\nratio\nnum_enrolled_school_children %/% num_aged_school_children\nNA %/% NA\nNA\nNA\n0.6874563\n0.6054471\n0.7694654\n89\n89\n88.12226\n88.12226\nratio @/@ num_enrolled_school_children %/% NA -/- num_aged_school_children %/% NA @/@ NA %/% NA\n\n\nratio\nnum_enrolled_school_children %/% num_aged_school_children\nNA %/% NA\nadmin1\nadmin1a\n0.6881720\n0.5646192\n0.8117249\n29\n29\n15.59140\n15.59140\nratio @/@ num_enrolled_school_children %/% NA -/- num_aged_school_children %/% NA @/@ admin1 %/% admin1a\n\n\nratio\nnum_enrolled_school_children %/% num_aged_school_children\nNA %/% NA\nadmin1\nadmin1b\n0.6461538\n0.4939644\n0.7983432\n25\n25\n30.86420\n30.86420\nratio @/@ num_enrolled_school_children %/% NA -/- num_aged_school_children %/% NA @/@ admin1 %/% admin1b\n\n\nratio\nnum_enrolled_school_children %/% num_aged_school_children\nNA %/% NA\nadmin1\nadmin1c\n0.7173913\n0.5887553\n0.8460273\n35\n35\n41.66667\n41.66667\nratio @/@ num_enrolled_school_children %/% NA -/- num_aged_school_children %/% NA @/@ admin1 %/% admin1c\n\n\n\n\n\n\nArguments of create_analysis_ratio\n\ncreate_analysis_ratio has two arguments: numerator_NA_to_0 and filter_denominator_0 that by default are set to TRUE.\n\nnumerator_NA_to_0 will turn all NA of the numerator into 0’s, default TRUE.\nfilter_denominator_0 will remove all rows with 0’s in the denominator, default TRUE.\n\nThe following example show a dataset with the number of children (num_children), the number of children enrolled to a school (num_enrolled) and the number of children attending school on a regular basis (num_attending).\n\nschool_ex &lt;- data.frame(\n  hh = c(\"hh1\", \"hh2\", \"hh3\", \"hh4\"),\n  num_children = c(3, 0, 2, NA),\n  num_enrolled = c(3, NA, 0, NA),\n  num_attending = c(1, NA, NA, NA)\n  )\n\nme_design &lt;- srvyr::as_survey(school_ex)\n\nschool_ex\n\n\n\n\nhh\nnum_children\nnum_enrolled\nnum_attending\n\n\n\nhh1\n3\n3\n1\n\n\nhh2\n0\nNA\nNA\n\n\nhh3\n2\n0\nNA\n\n\nhh4\nNA\nNA\nNA\n\n\n\n\n\n\n\nWhat is the ratio between children attending school and the number of children ?\nHow many households are included in the calculation?\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\nDefault value will give a ratio of 0.2 as there are 1 child out of 5 attending school.\nnumerator: 1 child from hh1 and 0 from hh3.\ndenominator: 3 from hh1 and 2 from hh3. In the hh3, the num_attending is NA because there is a skip logic, there cannot be a child attending as none are enrolled.\nBy default, the function has the argument numerator_NA_to_0 set to TRUE to turn that NA into a 0.\nn and n_total are 2 as 2 households were included in the calculation. hh2 was not included in the calculation of totals. The argument filter_denominator_0 set to TRUE removes that row.\n\ncreate_analysis_ratio(me_design,\n  analysis_var_numerator = \"num_attending\",\n  analysis_var_denominator = \"num_children\") %&gt;%\n  select(analysis_type, analysis_var, stat, n, n_total, analysis_key)\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nstat\nn\nn_total\nanalysis_key\n\n\nratio\nnum_attending %/% num_children\n0.2\n2\n2\nratio @/@ num_attending %/% NA -/- num_children %/% NA @/@ NA %/% NA\n\n\n\n\n\n\n\n\n\nWhat will be the ratio if only numerator_NA_to_0 is set to FALSE ?\nHow many households are included in the calculation?\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\nRatio will be 1/3, as hh3 with 2 children and NA for attending will be removed with the na.rm = T inside the survey_ratio calculation.\nn and n_total is 1 as only 1 household was used.\n\ncreate_analysis_ratio(me_design,\n                      analysis_var_numerator = \"num_attending\",\n                      analysis_var_denominator = \"num_children\",\n                      numerator_NA_to_0 = FALSE) %&gt;% \n  select(analysis_type, analysis_var, stat, n, n_total, analysis_key)\n\nWarning: There were 2 warnings in `dplyr::summarise()`.\nThe first warning was:\nℹ In argument: `srvyr::survey_ratio(...)`.\nCaused by warning in `qt()`:\n! NaNs produced\nℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nstat\nn\nn_total\nanalysis_key\n\n\nratio\nnum_attending %/% num_children\n0.3333333\n1\n1\nratio @/@ num_attending %/% NA -/- num_children %/% NA @/@ NA %/% NA\n\n\n\n\n\n\n\n\n\nWhat will be the ratio if only filter_denominator_0 is set to FALSE ?\nHow many households are included in the calculation?\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\nratio will be 0.2 as there are 1 child out of 5 attending school. The number of household counted, n and n_total, is equal to 3 instead 2. The household with 0 child is counted in the totals. (01 + 0 + 0) / (3 + 0 + 2)\n\ncreate_analysis_ratio(me_design,\n                      analysis_var_numerator = \"num_attending\",\n                      analysis_var_denominator = \"num_children\",\n                      filter_denominator_0 = FALSE)  %&gt;% \n  select(analysis_type, analysis_var, stat, n, n_total, analysis_key)\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\nstat\nn\nn_total\nanalysis_key\n\n\nratio\nnum_attending %/% num_children\n0.2\n3\n3\nratio @/@ num_attending %/% NA -/- num_children %/% NA @/@ NA %/% NA"
  },
  {
    "objectID": "03-session3.html#create_loa_from_results",
    "href": "03-session3.html#create_loa_from_results",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "create_loa_from_results",
    "text": "create_loa_from_results\nIf the loa that was used was shared, it can be re-used. Otherwise, with the results table and the analysis key, the function create_loa_from_results will generate a loa that can be used to create the analysis for the review.\n\nmy_loa_for_review &lt;- my_results_with_ratio$results_table %&gt;% \n  create_loa_from_results()\n\nmy_loa_for_review\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type\nanalysis_var\ngroup_var\nlevel\nanalysis_var_numerator\nanalysis_var_denominator\nnumerator_NA_to_0\nfilter_denominator_0\n\n\n\nprop_select_one\nadmin1\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nmean\nincome_v1_salaried_work\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nmedian\nincome_v1_salaried_work\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nmean\nexpenditure_debt\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nmedian\nexpenditure_debt\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nratio\nNA\nNA\n0.95\nnum_enrolled_school_children\nnum_aged_school_children\nTRUE\nTRUE\n\n\nprop_select_one\nwash_drinkingwatersource\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nNA\n0.95\nNA\nNA\nNA\nNA\n\n\nmean\nincome_v1_salaried_work\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\nmedian\nincome_v1_salaried_work\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\nmean\nexpenditure_debt\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\nmedian\nexpenditure_debt\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\nratio\nNA\nadmin1\n0.95\nnum_enrolled_school_children\nnum_aged_school_children\nTRUE\nTRUE\n\n\nprop_select_one\nwash_drinkingwatersource\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nadmin1\n0.95\nNA\nNA\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\n\n\nNota\n\n\n\ncreate_loa_from_results will not guess the arguments for numerator_NA_to_0 and filter_denominator_0, they will be set to TRUE by default.\nThe confidence level will also be set to .95 by default."
  },
  {
    "objectID": "03-session3.html#review_analysis",
    "href": "03-session3.html#review_analysis",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "review_analysis",
    "text": "review_analysis\n\n\n\n\n\n\nreview_*\n\n\n\n\nreview_* functions will review an object by comparing it to standards or another object and flags differences, e.g. reviewing the cleaning by comparing the raw dataset, the clean dataset and the cleaning log, analysis comparing it with another analysis.\n\n\nreview_analysis will compare 2 results together and present the differences. It will not check how the analysis was created nor check for inconsistencies. That mean, to review an analysis, it is necessary to create one and compare them.\n\nmy_design_for_review &lt;- srvyr::as_survey_design(my_data, weights = \"weights\", strata = \"admin1\")\nanalysis_for_review &lt;- create_analysis(my_design_for_review, my_loa_for_review, sm_separator = \"/\")\n\nbinded_table &lt;- my_results_with_ratio$results_table %&gt;% \n  left_join(analysis_for_review$results_table, by = \"analysis_key\")\n\n\nmy_review &lt;- review_analysis(binded_table)\n\ntypeof(my_review)\n\n[1] \"list\"\n\nnames(my_review)\n\n[1] \"results_table\" \"review_table\" \n\n\n\nmy_review$review_table %&gt;%\n  head()\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_key\nstat\nreview_check\nreview_comment\nanalysis_type\nanalysis_var\ngroup_var\n\n\n\nprop_select_one @/@ admin1 %/% admin1a @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nprop_select_one\nadmin1\nNA\n\n\nprop_select_one @/@ admin1 %/% admin1b @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nprop_select_one\nadmin1\nNA\n\n\nprop_select_one @/@ admin1 %/% admin1c @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nprop_select_one\nadmin1\nNA\n\n\nmean @/@ income_v1_salaried_work %/% NA @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nmean\nincome_v1_salaried_work\nNA\n\n\nmedian @/@ income_v1_salaried_work %/% NA @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nmedian\nincome_v1_salaried_work\nNA\n\n\nmean @/@ expenditure_debt %/% NA @/@ NA %/% NA\nstat.x\nTRUE\nSame results\nmean\nexpenditure_debt\nNA\n\n\n\n\n\n\n\nmy_review$review_table %&gt;%\n  group_by(stat, review_check, review_comment) %&gt;%\n  tally()\n\n\n\n\nstat\nreview_check\nreview_comment\nn\n\n\nstat.x\nTRUE\nSame results\n147\n\n\n\n\n\n\n\n\n\n\n\n\nNota\n\n\n\nanalysis_key are equivalent of an unique identifier. All analysis key should be unique.\n\n\njittered_results_table &lt;- binded_table\nset.seed(123)\njittered_results_table[sample(1:nrow(jittered_results_table), 5), \"stat.x\"] &lt;- sample(unique(jittered_results_table$stat.x), 5, T)\nset.seed(124)\njittered_results_table[sample(1:nrow(jittered_results_table), 5), \"stat.y\"] &lt;- sample(unique(jittered_results_table$stat.y), 5, T)\nset.seed(125)\njittered_results_table[sample(1:nrow(jittered_results_table), 5), \"stat.x\"] &lt;- NA\nset.seed(1236)\njittered_results_table[sample(1:nrow(jittered_results_table), 5), \"stat.y\"] &lt;- NA\n\n\nmy_jittered_review &lt;- review_analysis(jittered_results_table, \n                                      stat_columns_to_review = \"stat.x\",\n                                      stat_columns_to_compare_with = \"stat.y\")\nmy_jittered_review$review_table %&gt;%\n  group_by(stat, review_check, review_comment) %&gt;%\n  tally()\n\n\n\n\nstat\nreview_check\nreview_comment\nn\n\n\n\nstat.x\nFALSE\nDifferent results\n10\n\n\nstat.x\nFALSE\nMissing in stat.x\n5\n\n\nstat.x\nFALSE\nMissing in stat.y\n5\n\n\nstat.x\nTRUE\nSame results\n127\n\n\n\n\n\n\n\nmy_jittered_review$results_table %&gt;%\n  filter(!review_check_stat.x) %&gt;% \n  head(10)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nanalysis_type.x\nanalysis_var.x\nanalysis_var_value.x\ngroup_var.x\ngroup_var_value.x\nstat.x\nstat_low.x\nstat_upp.x\nn.x\nn_total.x\nn_w.x\nn_w_total.x\nanalysis_key\nanalysis_type.y\nanalysis_var.y\nanalysis_var_value.y\ngroup_var.y\ngroup_var_value.y\nstat.y\nstat_low.y\nstat_upp.y\nn.y\nn_total.y\nn_w.y\nn_w_total.y\nreview_check_stat.x\nreview_comment_stat.x\n\n\n\nprop_select_one\nwash_drinkingwatersource\nborehole_tubewell\nNA\nNA\nNA\n-0.0009366\n0.0839997\n4\n100\n4.1531547\n100.00000\nprop_select_one @/@ wash_drinkingwatersource %/% borehole_tubewell @/@ NA %/% NA\nprop_select_one\nwash_drinkingwatersource\nborehole_tubewell\nNA\nNA\n0.0415315\n-0.0009366\n0.0839997\n4\n100\n4.1531547\n100.00000\nFALSE\nMissing in stat.x\n\n\nprop_select_one\nwash_drinkingwatersource\npiped_into_compound\nNA\nNA\n0.0657820\n0.0199103\n0.1354632\n7\n100\n7.7686750\n100.00000\nprop_select_one @/@ wash_drinkingwatersource %/% piped_into_compound @/@ NA %/% NA\nprop_select_one\nwash_drinkingwatersource\npiped_into_compound\nNA\nNA\n0.0776867\n0.0199103\n0.1354632\n7\n100\n7.7686750\n100.00000\nFALSE\nDifferent results\n\n\nprop_select_one\nwash_drinkingwatersource\nrain_water_collection\nNA\nNA\n0.0291859\n-0.0055007\n0.0638725\n3\n100\n2.9185868\n100.00000\nprop_select_one @/@ wash_drinkingwatersource %/% rain_water_collection @/@ NA %/% NA\nprop_select_one\nwash_drinkingwatersource\nrain_water_collection\nNA\nNA\n0.4285714\n-0.0055007\n0.0638725\n3\n100\n2.9185868\n100.00000\nFALSE\nDifferent results\n\n\nprop_select_one\nwash_drinkingwatersource\nunprotected_spring\nNA\nNA\nNA\n-0.0055476\n0.0656830\n3\n100\n3.0067702\n100.00000\nprop_select_one @/@ wash_drinkingwatersource %/% unprotected_spring @/@ NA %/% NA\nprop_select_one\nwash_drinkingwatersource\nunprotected_spring\nNA\nNA\n0.0300677\n-0.0055476\n0.0656830\n3\n100\n3.0067702\n100.00000\nFALSE\nMissing in stat.x\n\n\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nlack_qualified_staff\nNA\nNA\nNA\n0.4723972\n0.6786524\n57\n100\n57.5524834\n100.00000\nprop_select_multiple @/@ edu_learning_conditions_reasons_v1 %/% lack_qualified_staff @/@ NA %/% NA\nprop_select_multiple\nedu_learning_conditions_reasons_v1\nlack_qualified_staff\nNA\nNA\n0.5755248\n0.4723972\n0.6786524\n57\n100\n57.5524834\n100.00000\nFALSE\nMissing in stat.x\n\n\nmean\nincome_v1_salaried_work\nNA\nadmin1\nadmin1b\n0.1612903\n19.0489416\n20.5066140\n27\n27\n33.3333333\n33.33333\nmean @/@ income_v1_salaried_work %/% NA @/@ admin1 %/% admin1b\nmean\nincome_v1_salaried_work\nNA\nadmin1\nadmin1b\n19.7777778\n19.0489416\n20.5066140\n27\n27\n33.3333333\n33.33333\nFALSE\nDifferent results\n\n\nmean\nexpenditure_debt\nNA\nadmin1\nadmin1c\n0.5229561\n19.6006716\n20.8755188\n42\n42\n50.0000000\n50.00000\nmean @/@ expenditure_debt %/% NA @/@ admin1 %/% admin1c\nmean\nexpenditure_debt\nNA\nadmin1\nadmin1c\n20.2380952\n19.6006716\n20.8755188\n42\n42\n50.0000000\n50.00000\nFALSE\nDifferent results\n\n\nprop_select_one\nwash_drinkingwatersource\nwater_kiosk\nadmin1\nadmin1a\nNA\n-0.0317653\n0.0962814\n1\n31\n0.5376344\n16.66667\nprop_select_one @/@ wash_drinkingwatersource %/% water_kiosk @/@ admin1 %/% admin1a\nprop_select_one\nwash_drinkingwatersource\nwater_kiosk\nadmin1\nadmin1a\n0.0322581\n-0.0317653\n0.0962814\n1\n31\n0.5376344\n16.66667\nFALSE\nMissing in stat.x\n\n\nprop_select_one\nwash_drinkingwatersource\nbottled_water\nadmin1\nadmin1b\n0.0370370\n-0.0364712\n0.1105453\n1\n27\n1.2345679\n33.33333\nprop_select_one @/@ wash_drinkingwatersource %/% bottled_water @/@ admin1 %/% admin1b\nprop_select_one\nwash_drinkingwatersource\nbottled_water\nadmin1\nadmin1b\n19.8709677\n-0.0364712\n0.1105453\n1\n27\n1.2345679\n33.33333\nFALSE\nDifferent results\n\n\nprop_select_one\nwash_drinkingwatersource\nother\nadmin1\nadmin1c\n0.0476190\n-0.0183900\n0.1136281\n2\n42\n2.3809524\n50.00000\nprop_select_one @/@ wash_drinkingwatersource %/% other @/@ admin1 %/% admin1c\nprop_select_one\nwash_drinkingwatersource\nother\nadmin1\nadmin1c\n20.0000000\n-0.0183900\n0.1136281\n2\n42\n2.3809524\n50.00000\nFALSE\nDifferent results"
  },
  {
    "objectID": "03-session3.html#exercise-1-1",
    "href": "03-session3.html#exercise-1-1",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "Exercise 1",
    "text": "Exercise 1\n\nlibrary(analysistools)\nlibrary(dplyr)\n\nmy_data &lt;- analysistools::analysistools_MSNA_template_data\n\nsampling_frame &lt;- data.frame(\n  strata = c(\"admin1a\", \"admin1b\", \"admin1c\"),\n  population = c(100000, 200000, 300000)\n)\n\nCreate the analysis for the following indicators:\n\n% of households having/had soap at home\n% of households by type of primary source of drinking water\n% of households by self-reported barriers to accessing health care\n\nAverage household income over the 30 days prior to data collection (total)\nMedian household income over the 30 days prior to data collection (total)\nAverage household expenditures in the 6 months prior to data collection (health)\nMedian household expenditures in the 6 months prior to data collection (health)\nRatio household expenditures on health in the 6 months prior to data collection and the household income over the 30 days prior to data collection.\n% of households per number of days when the household had to restrict consumption by adults in order for small children to eat to cope with a lack of food or money to buy it.\n\nThe analysis should be at admin1 level (the strata).\n\n\n\n\n\n\n\n\n\n\nname\nlabel::english\ntype\n\n\n\nincome_v2_total\nCan you estimate your household’s total income (in local currency) over the last 30 days from all sources? Please only report income received in the form of money, not items or services.\ninteger\n\n\nexpenditure_health\n3. Health-related expenditures (healthcare, medicine, etc.)\ninteger\n\n\nrCSIMealAdult\nDuring the last 7 days, were there days (and, if so, how many) when your household had to restrict consumption by adults in order for small children to eat to cope with a lack of food or money to buy it?\ninteger\n\n\nwash_drinkingwatersource\nWhat is the main source of drinking water for members of your household?\nselect_one wash_drinkingwatersource\n\n\nwash_soap\nDo you have soap or detergent in your household for washing hands? [if not remote] Can you show it to me?\nselect_one wash_soap\n\n\nhealth_barriers\nWhat are your barriers to access health care?\nselect_multiple health_barriers\n\n\n\n\n\n\n\nexercise_data &lt;- analysistools::analysistools_MSNA_template_data\n\nexercise_sampling_frame &lt;- data.frame(\n  strata = c(\"admin1a\", \"admin1b\", \"admin1c\"),\n  population = c(100000, 200000, 300000)\n)\n\ntemplate_loa &lt;- readxl::read_excel(\"inputs/08 - exercise - template loa.xlsx\")\n\n\n\n\n\n\n\nExpand to get a hint\n\n\n\n\n\nrCSIMealAdult should be analysed as a categorical variable not a numerical variable to get the proportion per day.\n\n\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nexercise_data &lt;- exercise_data %&gt;%\n  add_weights(\n    exercise_sampling_frame,\n    \"admin1\", \"strata\", \"population\"\n  )\n\nexercise_design &lt;- srvyr::as_survey_design(exercise_data, weights = \"weights\", strata = \"admin1\")\n\nexercise_loa &lt;- readxl::read_excel(\"inputs/09 - correction - loa.xlsx\")\n\nexercise_results &lt;- create_analysis(exercise_design, loa = exercise_loa, sm_separator = \"/\")"
  },
  {
    "objectID": "03-session3.html#exercise-2-1",
    "href": "03-session3.html#exercise-2-1",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "Exercise 2",
    "text": "Exercise 2\n\nReview this analysis\n\nThere is no weights. The strata are admin1\n\nanalysis_to_review &lt;- readxl::read_excel(\"inputs/10 - exercise - analysis_to_review.xlsx\")\ndataset_to_review &lt;- readxl::read_excel(\"inputs/10 - exercise - analysis_to_review.xlsx\", sheet = \"dataset\")\n\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nloa_for_review &lt;- analysis_to_review %&gt;% \n  create_loa_from_results()\n\nreview_design &lt;- srvyr::as_survey_design(dataset_to_review, strata = \"admin1\")\nmy_analysis_exercise &lt;- create_analysis(review_design, loa = loa_for_review, sm_separator = \"/\")\n\nJoining with `by = join_by(admin1, respondent_gender)`\nJoining with `by = join_by(admin1, ind_gender)`\nJoining with `by = join_by(admin1, caregiver_available)`\nJoining with `by = join_by(admin1, difficulty_self_care)`\n■■■■■■■■ 24% | ETA: 4s\nJoining with `by = join_by(admin1, edu_modality_v2)`\nJoining with `by = join_by(admin1, liv_emerg_csi_3)`\nJoining with `by = join_by(admin1, fs_hhs_nofood_yn)`\nJoining with `by = join_by(admin1, wash_handwashingfacility_observed_water)`\nJoining with `by = join_by(admin1, wash_handwashingfacility_observed_soap)`\nJoining with `by = join_by(admin1, hoh_age)`\n\nmy_results_table_shorter &lt;- my_analysis_exercise$results_table %&gt;% \n  select(analysis_key, stat)\n\nbinded_results_table &lt;- analysis_to_review %&gt;% \n  full_join(my_results_table_shorter, by = \"analysis_key\")\n\nexercise_review &lt;- review_analysis(binded_results_table,\n                                   stat_columns_to_review = \"stat.x\",\n                                   stat_columns_to_compare_with = \"stat.y\", \n                                   analysis_key_column = \"analysis_key\")\n\nexercise_review$review_table %&gt;% \n  group_by(review_check,review_comment) %&gt;% \n  tally()\n\n\n\n\nreview_check\nreview_comment\nn\n\n\nTRUE\nSame results\n134"
  },
  {
    "objectID": "03-session3.html#extra",
    "href": "03-session3.html#extra",
    "title": "03 - R framework with IMPACT - session 3",
    "section": "Extra",
    "text": "Extra\nHow you would review an analysis that does not have an analysis key? (discussion)\n\n\n\n\n\n\nExpand to get the answer\n\n\n\n\n\n\nIf the analysis is in long format, add the analysis key.\nIf the analysis is in a wide format, change to long format then add the analysis key."
  }
]